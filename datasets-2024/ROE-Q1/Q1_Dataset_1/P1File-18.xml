<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]>
<us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230225583A1-20230720.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20230704" date-publ="20230720">
<us-bibliographic-data-application lang="EN" country="US">
<publication-reference>
<document-id>
<country>US</country>
<doc-number>20230225583</doc-number>
<kind>A1</kind>
<date>20230720</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>17917241</doc-number>
<date>20210408</date>
</document-id>
</application-reference>
<us-application-series-code>17</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>CN</country>
<doc-number>202010268293.7</doc-number>
<date>20200408</date>
</priority-claim>
</priority-claims>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>1</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>1</main-group>
<subgroup>04</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>1</main-group>
<subgroup>273</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>06</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>23</main-group>
<subgroup>698</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classifications-cpc>
<main-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>1</main-group>
<subgroup>00006</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
</main-cpc>
<further-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>1</main-group>
<subgroup>041</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>1</main-group>
<subgroup>00158</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20220201</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>1</main-group>
<subgroup>00097</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>1</main-group>
<subgroup>2736</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>061</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20230101</date></cpc-version-indicator>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>23</main-group>
<subgroup>698</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20160201</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>2090</main-group>
<subgroup>067</subgroup>
<symbol-position>L</symbol-position>
<classification-value>A</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
</further-cpc>
</classifications-cpc>
<invention-title id="d2e61">SYSTEM AND METHOD FOR CONTROLLING CAPSULE ENDOSCOPE</invention-title>
<us-parties>
<us-applicants>
<us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee">
<addressbook>
<orgname>Ankon Medical Technologies (Shanghai) Co., LTD</orgname>
<address>
<city>Shanghai</city>
<country>CN</country>
</address>
</addressbook>
<residence>
<country>CN</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="00" designation="us-only">
<addressbook>
<last-name>DUAN</last-name>
<first-name>Xiaodong</first-name>
<address>
<city>Pleasanton</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="01" designation="us-only">
<addressbook>
<last-name>WANG</last-name>
<first-name>Qingqing</first-name>
<address>
<city>Shanghai</city>
<country>CN</country>
</address>
</addressbook>
</inventor>
</inventors>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>Ankon Medical Technologies (Shanghai) Co., LTD.</orgname>
<role>03</role>
<address>
<city>Shanghai</city>
<country>CN</country>
</address>
</addressbook>
</assignee>
<assignee>
<addressbook>
<orgname>ANX IP HOLDING PTE. LTD.</orgname>
<role>03</role>
<address>
<city>SG</city>
<country>SG</country>
</address>
</addressbook>
</assignee>
</assignees>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/CN2021/085891</doc-number>
<date>20210408</date>
</document-id>
<us-371c12-date><date>20230313</date></us-371c12-date>
</pct-or-regional-filing-data>
</us-bibliographic-data-application>
<abstract id="abstract">
<p id="p-0001" num="0000">A system and method for controlling a capsule endoscope is provided. The control method includes: measuring a magnetic field value of the environment in which the capsule endoscope is subjected; obtaining a critical magnetic field value for suspension of the capsule endoscope according to the magnetic field value; adjusting a traction force on the capsule endoscope according to the critical magnetic field value for suspension; and controlling the movement of the capsule endoscope in a horizontal and/or vertical direction, wherein the movement of the first magnet is controlled by moving the second magnet, and the capsule endoscope is in a quasi-suspended state as moving in the horizontal and/or vertical direction. The system and method reduce friction between the capsule endoscope and wall of the target area during movement by controlling the capsule endoscope in a quasi-suspended state, which makes the scanning of the target area more accurate.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="184.74mm" wi="74.00mm" file="US20230225583A1-20230720-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="194.06mm" wi="76.03mm" file="US20230225583A1-20230720-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="244.35mm" wi="75.61mm" file="US20230225583A1-20230720-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="187.96mm" wi="72.98mm" file="US20230225583A1-20230720-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="76.28mm" wi="68.24mm" file="US20230225583A1-20230720-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="188.04mm" wi="103.46mm" file="US20230225583A1-20230720-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="82.55mm" wi="93.47mm" file="US20230225583A1-20230720-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE OF RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">The application is a National Phase Application of PCT International Application No. PCT/CN2021/085891, International Filing Date Apr. 8, 2021, published Oct. 14, 2021 as International Publication Number WO2021/204182A1, which claims priority from Chinese Patent Application No. 202010268293.7, filed Apr. 8, 2020, all of which are incorporated herein by reference in their entirety.</p>
<?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?>
<?summary-of-invention description="Summary of Invention" end="lead"?>
<heading id="h-0002" level="1">FIELD OF INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to the art of a capsule endoscope, and more particularly to a system and method for controlling the capsule endoscope.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">With the development of magnetically controlled capsule endoscopy, the accuracy of a magnetically controlled capsule endoscope during gastric examination has been consistent with that of conventional gastroscopy, which is a comfortable and safe way to perform gastric endoscopy. The magnetically controlled capsule endoscope includes a magnet inside, and the movement of the capsule endoscope in the stomach is controlled by the force of interaction between an external magnet and an internal magnet thereby.</p>
<p id="p-0005" num="0004">When using the magnetically controlled capsule endoscope, a dragging walk over the surface of the stomach is generally used. Although this approach is an intuitive way of control, it usually has uncertainty leading to failure of the dragging walk because of the friction between the capsule endoscope and the stomach wall related to the local environment and the forces on the capsule endoscope.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0006" num="0005">The present invention discloses a system and a method for controlling a capsule endoscope. Specifically, the traction force required to make the capsule endoscope in a quasi-suspended state is calculated by detecting the location of the capsule endoscope so that the friction between the capsule endoscope and the wall of a target area is greatly reduced and therefore it is easier to move the capsule.</p>
<p id="p-0007" num="0006">According to an aspect of the present invention, there is provided a system for controlling a capsule endoscope comprising: a capsule endoscope, the capsule endoscope comprising an image acquisition module, a first magnet, a battery module, a wireless module and a sensor module; a control unit for receiving data transmitted from the capsule endoscope to calculate a critical magnetic field value for suspension and obtaining a control signal based on the critical magnetic field value for suspension; a movement unit and a second magnet, the movement unit controlling the second magnet to move in a horizontal and/or vertical direction according to the control signal, wherein the movement of the first magnet is controlled by moving the second magnet, and the capsule endoscope is in a quasi-suspended state as moving in the horizontal and/or vertical direction.</p>
<p id="p-0008" num="0007">Preferably, the sensor module comprises a magnetic sensor and an acceleration sensor.</p>
<p id="p-0009" num="0008">Preferably, the magnetic sensor is located away from the first magnet and the acceleration sensor is a gravity sensor.</p>
<p id="p-0010" num="0009">Preferably, the sensing directions of the magnetic sensor and the acceleration sensor are along the long axis of the capsule endoscope.</p>
<p id="p-0011" num="0010">Preferably, the direction of magnetization of the first magnet is along the long axis of the capsule endoscope.</p>
<p id="p-0012" num="0011">Preferably, there is an angle between the direction of magnetization of the second magnet and the vertical direction, and the angle has a magnitude of 0-20&#xb0;.</p>
<p id="p-0013" num="0012">Preferably, the movement unit comprises a robot with three-dimensional movement, a right angle coordinate robot or a robotic arm.</p>
<p id="p-0014" num="0013">Preferably, the second magnet comprises a permanent magnet or an electromagnet.</p>
<p id="p-0015" num="0014">Preferably, the control system further comprises: an image unit, which is used for receiving a plurality of images captured by the capsule endoscope and building a three-dimensional spatial structure for the target area.</p>
<p id="p-0016" num="0015">Preferably, the image unit obtains a panoramic image of the target area according to the captured images, and the image unit obtains the three-dimensional spatial structure of the target area according to the panoramic image.</p>
<p id="p-0017" num="0016">Preferably, the control system further comprises: a locating unit, which is used for recording position information and/or movement trajectory of the capsule endoscope. The image unit obtains the three-dimensional spatial structure of the target area according to the position information and/or movement trajectory.</p>
<p id="p-0018" num="0017">Preferably, the means for controlling the movement of the second magnet in the horizontal and/or vertical direction comprises manual control means controlled by the movement unit and automatic control means controlled by the control unit.</p>
<p id="p-0019" num="0018">According to another aspect of the present invention, there is provided a method for controlling the capsule endoscope. The capsule endoscope comprises a first magnet inside the capsule endoscope, and a second magnet outside the capsule endoscope controls the movement of the capsule endoscope. The method comprises: measuring a magnetic field value of an environment in which the capsule endoscope is subjected; obtaining a critical magnetic field value for suspension of the capsule endoscope according to the magnetic field value; adjusting a traction force on the capsule endoscope according to the critical magnetic field value for suspension; and controlling the movement of the capsule endoscope in the horizontal and/or vertical direction, wherein the movement of the first magnet is controlled by moving the second magnet, and the capsule endoscope is in a quasi-suspended state as moving in the horizontal and/or vertical direction.</p>
<p id="p-0020" num="0019">Preferably, the magnetic field value is measured by a magnetic sensor.</p>
<p id="p-0021" num="0020">Preferably, the critical magnetic field value for suspension is obtained based on the gravitational force of the capsule endoscope, tilt angle of the capsule endoscope and buoyancy force of the capsule endoscope.</p>
<p id="p-0022" num="0021">Preferably, the step of adjusting the traction force on the capsule endoscope according to the critical magnetic field value for suspension comprises: obtaining a corrected magnetic field value according to the critical magnetic field value for suspension; adjusting the height of the second magnet according to the corrected magnetic field value, thereby adjusting the traction force on the capsule endoscope.</p>
<p id="p-0023" num="0022">Preferably, when the tilt angle of the capsule endoscope is greater than zero, it is determined that the capsule endoscope encounters an obstacle.</p>
<p id="p-0024" num="0023">Preferably, when the capsule endoscope encounters an obstacle, the capsule endoscope is controlled to move in the vertical direction by a change in magnetic field gradient of the second magnet in the vertical direction, and the capsule endoscope is controlled to move in the horizontal direction by manipulating the second magnet to move in the horizontal direction to cross the obstacle.</p>
<p id="p-0025" num="0024">Preferably, the means for controlling the movement of the capsule endoscope in the horizontal and/or vertical direction comprises manual control means and automatic control means.</p>
<p id="p-0026" num="0025">According to the aspects of the present invention, the capsule endoscope is controlled to be in a quasi-suspended state, that is, the mutual attraction between the second magnet and the first magnet is equal to or slightly greater than the weight of the capsule endoscope when it is at the upper wall of the target area, equal to or slightly less than the weight of the capsule endoscope when it is at the lower wall of the target area, and offsets the buoyancy force when there is liquid in the target area, so that the pressure between the capsule endoscope and the wall of the target area tends to zero, friction is greatly reduced, and the scanning of the target area is more accurate.</p>
<p id="p-0027" num="0026">According to the aspects of the present invention, when the capsule endoscope encounters an obstacle, the capsule endoscope is controlled to move in the vertical direction by a change in magnetic field gradient of the second magnet in the vertical direction, so as to achieve the purpose of crossing the obstacle.</p>
<p id="p-0028" num="0027">According to the aspects of the present invention, two control methods, i.e. automatic scanning and manual scanning are provided. If the position of interest is visible from the image captured by the automatic scanning method, the capsule endoscope can be controlled by the manual scanning method to move to the designated position of the target area for scanning, which improves the efficiency and accuracy of examination.</p>
<?summary-of-invention description="Summary of Invention" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0029" num="0028">The above and other objects and advantages of the present invention will be apparent upon consideration of the following detailed description, taken in conjunction with the accompanying drawings, in which the reference characters refer to like parts throughout and in which:</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a schematic illustration of a capsule endoscope according to an embodiment of the present invention.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIGS. <b>2</b><i>a </i>to <b>2</b><i>f </i></figref>show various situations of a method for controlling the capsule endoscope according to embodiments of the present invention.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a schematic illustration of a system for controlling the capsule endoscope according to an embodiment of the present invention.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. <b>4</b></figref> shows a zigzag scanning of the capsule endoscope against stomach wall according to an embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?detailed-description description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0034" num="0033">The present invention will be understood and appreciated more fully from the following detailed description taken in conjunction with the appended figures. Various exemplary embodiments are well illustrated in the accompanying figures with the intent that these examples not be restrictive. In the drawings, the same elements are represented by the same or similar markings. For simplicity and clarity of illustration, elements shown in the drawings have not been drawn to scale.</p>
<p id="p-0035" num="0034">In a method of controlling the movement of a capsule endoscope, the movement of the capsule endoscope in the target area (e.g. stomach) is generally controlled by controlling the interaction force between a magnet outside the capsule endoscope and an magnet inside the capsule endoscope. The target area is a confined space, which may be, for example, a bionic stomach, a stomach model, an isolated animal stomach, or a human stomach. Such movement is dragging on the surface of the target area. Although this means of movement is intuitive, it usually has uncertainty leading to failure of the dragging since the friction between the capsule endoscope and the wall of the target area (e.g. stomach wall) is related to local environment and the forces on the capsule endoscope.</p>
<p id="p-0036" num="0035">Specific embodiments of the present invention are described in further detail below in conjunction with the accompanying drawings.</p>
<p id="p-0037" num="0036">According to the aspects of the present invention, the interaction force between a second magnet outside the capsule endoscope and a first magnet inside the capsule endoscope is controlled to make the capsule endoscope in the target area in a quasi-suspended state, thus greatly reducing the friction between the capsule endoscope and the wall of the target area (e.g., stomach wall), and improving the efficiency of movement.</p>
<p id="p-0038" num="0037">The quasi-suspended state is a state in which a downward force received by the capsule endoscope is approximately equal to an upward force received by the capsule endoscope, and the capsule endoscope is roughly suspended without vertical movement in a vertical direction in the air without support. In this state, the friction on the wall of the target area (e.g., the stomach wall) is greatly reduced when the capsule endoscope is moved horizontally.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a schematic illustration of a capsule endoscope according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the capsule endoscope <b>110</b> comprises at least an image acquisition module <b>111</b>, a first magnet <b>112</b>, a battery module <b>113</b>, a wireless module <b>114</b>, and a sensor module <b>115</b>.</p>
<p id="p-0040" num="0039">Wherein, there may be one or two image acquisition modules <b>111</b>, which are used to capture images of the target area and output image data.</p>
<p id="p-0041" num="0040">The first magnet <b>112</b> drives the capsule endoscope <b>110</b> to move by the force of interaction with an external magnet outside the capsule endoscope <b>110</b>. The polarization direction of the first magnet <b>112</b> is along the long axis of the capsule endoscope <b>110</b> (shown as a dashed line in <figref idref="DRAWINGS">FIG. <b>1</b></figref>).</p>
<p id="p-0042" num="0041">The wireless module <b>114</b> transmits image data and sensed data to an external device through wireless communication.</p>
<p id="p-0043" num="0042">The sensor module <b>115</b> comprises an acceleration sensor and a magnetic sensor, the acceleration sensor for measuring tilt angle of the capsule endoscope and the magnetic sensor for measuring a magnetic field value of an environment in which the capsule endoscope is subjected (hereinafter referred to as &#x201c;ambient magnetic field&#x201d;). The sensor module <b>115</b> further comprises a sensor for detecting the presence of liquid in the target area and for measuring buoyancy force of the liquid. In other embodiments, the acceleration sensor may be a gyroscope or a gravity sensor to measure the tilt angle of the capsule endoscope.</p>
<p id="p-0044" num="0043">The magnetic sensor should be located away from the first magnet to avoid saturation. The reading of the magnetic field of the capsule endoscope <b>110</b> when it is away from the magnetic field source (e.g. an external magnet outside the capsule endoscope) is taken as the reading of the first magnet <b>112</b>. The ambient magnetic field of the capsule endoscope measured by the magnetic sensor minus the reading of the first magnet <b>112</b> is the reading of the external magnet in the environment.</p>
<p id="p-0045" num="0044">In the embodiment, the acceleration sensor and the magnetic sensor are preferably three-dimensional sensors, and may also be one-dimensional sensors, but when they are one-dimensional sensors, the sensing direction of the magnetic sensor and the acceleration sensor should be along the long axis of the capsule endoscope <b>110</b>.</p>
<p id="p-0046" num="0045">In the embodiment, by measuring the tilt angle of the capsule endoscope and the ambient magnetic field of the capsule endoscope, an external magnetic force and direction required for the capsule endoscope to reach the quasi-suspended state can be further calculated, so that the capsule endoscope can be moved in the quasi-suspended state. In detail, a critical magnetic field value for suspension of the capsule endoscope is obtained according to the ambient magnetic field; a traction force on the capsule endoscope is adjusted according to the critical magnetic field value for suspension; and the movement of the capsule endoscope is controlled in a horizontal and/or vertical direction in the quasi-suspended state.</p>
<p id="p-0047" num="0046">The center of gravity of the capsule endoscope <b>110</b> is in the vicinity of the long axis of the capsule endoscope <b>110</b> at a distance deviation of less than 2 mm, preferably, at a distance deviation of less than 0.5 mm.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIGS. <b>2</b><i>a </i>to <b>2</b><i>f </i></figref>show various situations of a method for controlling the capsule endoscope according to embodiments of the present invention. In the embodiment, a dual-camera capsule endoscope is preferably used, or a single-camera capsule endoscope can also be used. But when the single-camera capsule endoscope is used and the capsule endoscope is at the lower wall of the target area, the capsule endoscope needs to be flipped 180&#xb0; so that the camera is facing downward. In the following embodiment, the dual-camera capsule endoscope is taken as an example. Therefore, no matter whether the capsule endoscope is on the upper wall or the lower wall of the target area, it is not needed to change its orientation. As shown in <figref idref="DRAWINGS">FIGS. <b>2</b><i>a </i>to <b>2</b><i>f</i></figref>, the dual-camera capsule endoscope is described in terms of being on the upper wall of the stomach and the lower wall of the stomach.</p>
<p id="p-0049" num="0048">In the embodiment, the direction of magnetization of the first magnet in the capsule endoscope <b>110</b> is along the long axis of the capsule endoscope, and the capsule endoscope <b>110</b> is oriented vertically upward when taking images. Preferably, the second magnet is magnetized in the same direction as the first magnet, but in this case, complete symmetry would cause the capsule endoscope <b>110</b> to spin during critical suspension and result in unclear images. So, the direction of magnetization of the second magnet is tilted to the ground by a small angle of 0 to 20&#xb0;. That is, there is a small angle between the direction of magnetization of the second magnet and the vertical direction, and the angle is a magnitude of 0-20&#xb0;. Preferably, the small angle is 5&#xb0;. In the following embodiments, the second magnet is magnetized in the same direction as the first magnet means that the second magnet is tilted to the ground by the small angle.</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. <b>2</b><i>a </i></figref>and <figref idref="DRAWINGS">FIG. <b>2</b><i>b </i></figref>illustrate the situations where the capsule endoscope is located on the upper wall of the stomach and the lower wall of the stomach when the stomach has air.</p>
<p id="p-0051" num="0050">Referring to <figref idref="DRAWINGS">FIG. <b>2</b><i>a </i></figref>and <figref idref="DRAWINGS">FIG. <b>2</b><i>b</i></figref>, the direction of magnetization of the capsule endoscope <b>110</b> (the direction shown by the arrows in <figref idref="DRAWINGS">FIG. <b>2</b><i>a </i></figref>and <figref idref="DRAWINGS">FIG. <b>2</b><i>b</i></figref>) is consistent with the direction of magnetization of the external second magnet <b>230</b>. The second magnet is located directly above the capsule endoscope <b>110</b>. The capsule endoscope <b>110</b> is located below the upper wall <b>130</b> of the stomach (or above the lower wall <b>130</b> of the stomach), at a distance d from the second magnet <b>230</b>. The distance d is the distance from the center of the capsule endoscope <b>110</b> to the center of the second magnet <b>230</b>.</p>
<p id="p-0052" num="0051">At this point, the forces on the capsule endoscope <b>110</b> include a traction force F<sub>magnetic </sub>from the second magnet <b>230</b> and the gravitational force W<sub>capsule </sub>of the capsule endoscope <b>110</b> itself. The traction force F<sub>magnetic </sub>is upward. When the capsule endoscope <b>110</b> is in the quasi-suspended state, the traction force F<sub>magnetic </sub>is equal to the gravitational force W<sub>capsule</sub>, formula (4) can be obtained according to formulas (1) to (3) below.</p>
<p id="p-0053" num="0000">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mi>F</mi>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mfrac>
        <msub>
         <mi>&#x3bc;</mi>
         <mn>0</mn>
        </msub>
        <mrow>
         <mn>4</mn>
         <mo>&#x2062;</mo>
         <mi>&#x3c0;</mi>
        </mrow>
       </mfrac>
       <mo>&#xd7;</mo>
       <mfrac>
        <mrow>
         <mn>6</mn>
         <mo>&#x2062;</mo>
         <mi>Mm</mi>
        </mrow>
        <msup>
         <mi>d</mi>
         <mn>4</mn>
        </msup>
       </mfrac>
      </mrow>
      <mo>=</mo>
      <mi>W</mi>
     </mrow>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>1</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
<maths id="MATH-US-00001-2" num="00001.2">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mi>d</mi>
     <mo>=</mo>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <msub>
          <mi>&#x3bc;</mi>
          <mn>0</mn>
         </msub>
         <mrow>
          <mn>4</mn>
          <mo>&#x2062;</mo>
          <mi>&#x3c0;</mi>
         </mrow>
        </mfrac>
        <mo>&#xd7;</mo>
        <mfrac>
         <mrow>
          <mn>6</mn>
          <mo>&#x2062;</mo>
          <mi>Mm</mi>
         </mrow>
         <mi>W</mi>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>4</mn>
      </mrow>
     </msup>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>2</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
</p>
<p id="p-0054" num="0052">Wherein, the magnetic sensor in the capsule endoscope <b>110</b> detects a critical magnetic field value for suspension B<sub>cr</sub>. The critical magnetic field value for suspension B<sub>cr </sub>is calculated by the formula (4) below.</p>
<p id="p-0055" num="0000">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mi>B</mi>
      <mrow>
       <mi>c</mi>
       <mo>&#x2062;</mo>
       <mi>r</mi>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <mfrac>
       <msub>
        <mi>&#x3bc;</mi>
        <mn>0</mn>
       </msub>
       <mrow>
        <mn>4</mn>
        <mo>&#x2062;</mo>
        <mi>&#x3c0;</mi>
       </mrow>
      </mfrac>
      <mo>&#xd7;</mo>
      <mfrac>
       <mrow>
        <mn>2</mn>
        <mo>&#x2062;</mo>
        <mi>M</mi>
       </mrow>
       <msup>
        <mi>d</mi>
        <mn>3</mn>
       </msup>
      </mfrac>
     </mrow>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>3</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
<maths id="MATH-US-00002-2" num="00002.2">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mi>B</mi>
      <mrow>
       <mi>c</mi>
       <mo>&#x2062;</mo>
       <mi>r</mi>
      </mrow>
     </msub>
     <mo>=</mo>
     <mrow>
      <mfrac>
       <mrow>
        <msub>
         <mi>&#x3bc;</mi>
         <mn>0</mn>
        </msub>
        <mo>&#x2062;</mo>
        <mi>M</mi>
       </mrow>
       <mrow>
        <mn>2</mn>
        <mo>&#x2062;</mo>
        <mi>&#x3c0;</mi>
       </mrow>
      </mfrac>
      <mo>&#xd7;</mo>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mfrac>
          <msub>
           <mi>&#x3bc;</mi>
           <mn>0</mn>
          </msub>
          <mrow>
           <mn>4</mn>
           <mo>&#x2062;</mo>
           <mi>&#x3c0;</mi>
          </mrow>
         </mfrac>
         <mo>&#xd7;</mo>
         <mfrac>
          <mrow>
           <mn>6</mn>
           <mo>&#x2062;</mo>
           <mi>Mm</mi>
          </mrow>
          <mi>W</mi>
         </mfrac>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
        <mo>/</mo>
        <mn>4</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>4</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
</p>
<p id="p-0056" num="0053">In the above formulas (1) to (4), M is the magnetic moment of the second magnet <b>230</b>, m is the magnetic moment of the first magnet in the capsule endoscope <b>110</b>, to is vacuum permeability, d is the distance from the center of the capsule endoscope <b>110</b> to the center of the second magnet <b>230</b>, and W is the gravitational force of the capsule endoscope. F is the traction force from the second magnet <b>230</b>, that is, the attraction force between the second magnet <b>230</b> (magnet outside the capsule endoscope) and the first magnet (magnet inside the capsule endoscope).</p>
<p id="p-0057" num="0054">When the capsule endoscope <b>110</b> is located on the upper wall of the stomach, B&#x3e;B<sub>cr</sub>, e.g. B<sub>set</sub>=1.05B<sub>cr</sub>.</p>
<p id="p-0058" num="0055">When the capsule endoscope <b>110</b> is located on the lower wall of the stomach, B&#x3c;B<sub>cr</sub>, e.g. B<sub>set</sub>=0.95B<sub>cr</sub>.</p>
<p id="p-0059" num="0056">B and B<sub>set </sub>refer to magnetic field values of the second magnet <b>230</b>, and B<sub>set </sub>is a corrected magnetic field value. The corrected magnetic field value is obtained according to the critical magnetic field value for suspension B<sub>cr</sub>. At this point, the friction of the capsule endoscope has the following relationship: f<sub>friction</sub>=&#x3bc;N. When B&#x2dc;B<sub>cr</sub>, f<sub>friction</sub>&#x2248;0. Therefore, by constantly adjusting the height of the second magnet according to the corrected magnetic field value B<sub>set</sub>, the traction force of the capsule endoscope is adjusted, the capsule endoscope can reach the quasi-suspended state, and with the horizontal movement of the second magnet <b>230</b>, the capsule endoscope can be translated in a near suspended state.</p>
<p id="p-0060" num="0057"><figref idref="DRAWINGS">FIG. <b>2</b><i>c </i></figref>and <figref idref="DRAWINGS">FIG. <b>2</b><i>d </i></figref>illustrate the situations where the capsule endoscope is located on the upper wall of the stomach and the lower wall of the stomach when there is an obstacle in the stomach.</p>
<p id="p-0061" num="0058">Referring to <figref idref="DRAWINGS">FIG. <b>2</b><i>c </i></figref>and <figref idref="DRAWINGS">FIG. <b>2</b><i>d</i></figref>, since the stomach has an obstacle <b>101</b>, the capsule endoscope <b>110</b> is tilted when it encounters the obstacle <b>101</b> while traveling along the stomach wall. At which time there is an angular difference, i.e., a tilt angle &#x3b8;, between the direction of magnetization of the capsule endoscope <b>110</b> (the direction shown by the arrows in the <figref idref="DRAWINGS">FIG. <b>2</b><i>c </i></figref>and <figref idref="DRAWINGS">FIG. <b>2</b><i>d</i></figref>) and direction of magnetization of the external second magnet <b>230</b>. The second magnet is located directly above the capsule endoscope <b>110</b>. The capsule endoscope <b>110</b> is located below the upper wall <b>130</b> of the stomach (or above the lower wall <b>130</b> of the stomach), at a distance d from the second magnet <b>230</b>. The distance d is the distance from the center of the capsule endoscope <b>110</b> to the center of the second magnet <b>230</b>.</p>
<p id="p-0062" num="0059">At this point, the forces on the capsule endoscope <b>110</b> include the traction force F<sub>magnetic </sub>from the second magnet <b>230</b> and the gravitational force W capsule of the capsule endoscope <b>110</b> itself. The traction force F<sub>magnetic </sub>is upward. But since the capsule endoscope <b>110</b> is tilted when it encounters the obstacle, the tilt angle of the capsule endoscope <b>110</b> needs to be calculated by the acceleration sensor. That is, when the tilt angle of the capsule endoscope is greater than zero, it means that the capsule endoscope encounters an obstacle. Therefore, when the capsule endoscope <b>110</b> is in the quasi-suspended state, formula (8) can be obtained according to the formulas (5) to (7) below.</p>
<p id="p-0063" num="0000">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mi>F</mi>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mfrac>
        <msub>
         <mi>&#x3bc;</mi>
         <mn>0</mn>
        </msub>
        <mrow>
         <mn>4</mn>
         <mo>&#x2062;</mo>
         <mi>&#x3c0;</mi>
        </mrow>
       </mfrac>
       <mo>&#xd7;</mo>
       <mfrac>
        <mrow>
         <mn>6</mn>
         <mo>&#x2062;</mo>
         <mi>Mm</mi>
         <mo>&#x2062;</mo>
         <mi>cos</mi>
         <mo>&#x2062;</mo>
         <mi>&#x3b8;</mi>
        </mrow>
        <msup>
         <mi>d</mi>
         <mn>4</mn>
        </msup>
       </mfrac>
      </mrow>
      <mo>=</mo>
      <mi>W</mi>
     </mrow>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>5</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
<maths id="MATH-US-00003-2" num="00003.2">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mi>d</mi>
     <mo>=</mo>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <msub>
          <mi>&#x3bc;</mi>
          <mn>0</mn>
         </msub>
         <mrow>
          <mn>4</mn>
          <mo>&#x2062;</mo>
          <mi>&#x3c0;</mi>
         </mrow>
        </mfrac>
        <mo>&#xd7;</mo>
        <mfrac>
         <mrow>
          <mn>6</mn>
          <mo>&#x2062;</mo>
          <mi>M</mi>
          <mo>&#x2062;</mo>
          <mi>m</mi>
          <mo>&#x2062;</mo>
          <mi>cos</mi>
          <mo>&#x2062;</mo>
          <mi>&#x3b8;</mi>
         </mrow>
         <mi>W</mi>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>4</mn>
      </mrow>
     </msup>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>6</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
<maths id="MATH-US-00003-3" num="00003.3">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mrow>
      <mi>cos</mi>
      <mo>&#x2062;</mo>
      <mi>&#x3b8;</mi>
     </mrow>
     <mo>=</mo>
     <mfrac>
      <msub>
       <mi>g</mi>
       <mi>z</mi>
      </msub>
      <mi>g</mi>
     </mfrac>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>7</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
</p>
<p id="p-0064" num="0060">Wherein, the magnetic sensor in the capsule endoscope <b>110</b> detects the critical magnetic field value for suspension B<sub>cr</sub>. The critical magnetic field value for suspension B<sub>cr </sub>is calculated by the formula (8) below.</p>
<p id="p-0065" num="0000">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mrow>
      <msub>
       <mi>B</mi>
       <mrow>
        <mi>c</mi>
        <mo>&#x2062;</mo>
        <mi>r</mi>
       </mrow>
      </msub>
      <mo>(</mo>
      <mi>&#x3b8;</mi>
      <mo>)</mo>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mfrac>
       <mrow>
        <msub>
         <mi>&#x3bc;</mi>
         <mn>0</mn>
        </msub>
        <mo>&#x2062;</mo>
        <mi>M</mi>
       </mrow>
       <mrow>
        <mn>2</mn>
        <mo>&#x2062;</mo>
        <mi>&#x3c0;</mi>
       </mrow>
      </mfrac>
      <mo>&#xd7;</mo>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mfrac>
          <msub>
           <mi>&#x3bc;</mi>
           <mn>0</mn>
          </msub>
          <mrow>
           <mn>4</mn>
           <mo>&#x2062;</mo>
           <mi>&#x3c0;</mi>
          </mrow>
         </mfrac>
         <mo>&#xd7;</mo>
         <mfrac>
          <mrow>
           <mn>6</mn>
           <mo>&#x2062;</mo>
           <mi>Mm</mi>
           <mo>&#x2062;</mo>
           <mi>cos</mi>
           <mo>&#x2062;</mo>
           <mi>&#x3b8;</mi>
          </mrow>
          <mi>W</mi>
         </mfrac>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
        <mo>/</mo>
        <mn>4</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>8</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
</p>
<p id="p-0066" num="0061">In the above formulas (5) to (8), M is the magnetic moment of the second magnet <b>230</b>, m is the magnetic moment of the first magnet in the capsule endoscope <b>110</b>, to is the vacuum permeability, d is the distance from the center of the capsule endoscope <b>110</b> to the center of the second magnet <b>230</b>, and W is the gravitational force of the capsule endoscope. F is the traction force from the second magnet <b>230</b>, that is, the attraction force between the second magnet <b>230</b> (magnet outside the capsule endoscope) and the first magnet (magnet inside the capsule endoscope). g<sub>z </sub>is the axial acceleration component of the capsule endoscope, and g is the gravitational acceleration. In the embodiment of the present invention, the gravitational acceleration g is the total acceleration measured by the acceleration sensor, g=&#x221a;{square root over (g<sub>x</sub><sup>2</sup>+g<sub>y</sub><sup>2</sup>+g<sub>z</sub><sup>2</sup>)}, of which the value is not significantly different from 9.8. In some alternative embodiments, it can be considered that the gravitational acceleration g is a known parameter (e.g. 9.8), so a gravity sensor may be used instead of an acceleration sensor to reduce costs and to reduce the amount of calculations.</p>
<p id="p-0067" num="0062">When the capsule endoscope is located on the upper wall of the stomach, B&#x3e;B<sub>cr</sub>(&#x3b8;), e.g. B<sub>set</sub>(&#x3b8;)=1.05B<sub>cr</sub>(&#x3b8;)</p>
<p id="p-0068" num="0063">When the capsule endoscope is located on the lower wall of the stomach, B&#x3c;B<sub>cr</sub>(&#x3b8;), e.g. B<sub>set</sub>(&#x3b8;)=0.95B<sub>cr</sub>(&#x3b8;)</p>
<p id="p-0069" num="0064">B is the magnetic field value of the second magnet <b>230</b>. When the capsule endoscope is vertically upward, i.e., 0=0&#xb0;, cos 0=1, which is a suspended state of the capsule endoscope without obstacle, so the formula of B<sub>cr</sub>(&#x3b8;) includes the case of the capsule endoscope being vertically upward, and is used as a general formula for the cases with or without obstacles.</p>
<p id="p-0070" num="0065">The friction of the capsule endoscope has the following relationship: f<sub>friction</sub>. &#x3bc;N. When B&#x2dc;B<sub>cr</sub>, f<sub>friction</sub>&#x2248;0. Therefore, by constantly adjusting the height of the second magnet according to the corrected magnetic field value B<sub>set</sub>, the capsule endoscope can be translated in a near suspended state.</p>
<p id="p-0071" num="0066">In the embodiment, by changing the distance between the second magnet and the capsule endoscope <b>110</b>, and thus changing the traction force on the capsule endoscope <b>110</b> along the long axis of the capsule endoscope <b>110</b>, the capsule endoscope is moved along the long axis of the capsule endoscope <b>110</b>, and achieves the quasi-suspended state. Furthermore, with the horizontal movement of the second magnet <b>230</b>, the capsule endoscope can cross the obstacle. Since it is the changing of magnetic field gradient in the vertical direction of the second magnet that is used to cross the obstacle, it can be successful regardless of the size of the obstacle.</p>
<p id="p-0072" num="0067"><figref idref="DRAWINGS">FIG. <b>2</b><i>e </i></figref>and <figref idref="DRAWINGS">FIG. <b>2</b><i>f </i></figref>illustrate the situations where the capsule endoscope <b>110</b> is located on the upper wall of the stomach and the lower wall of the stomach when there is liquid <b>102</b> in the stomach.</p>
<p id="p-0073" num="0068">Referring to <figref idref="DRAWINGS">FIG. <b>2</b><i>e </i></figref>and <figref idref="DRAWINGS">FIG. <b>2</b><i>f</i></figref>, the direction of magnetization of the capsule endoscope <b>110</b> (the direction shown by the arrows in <figref idref="DRAWINGS">FIG. <b>2</b><i>e </i></figref>and <figref idref="DRAWINGS">FIG. <b>2</b><i>f</i></figref>) is consistent with the direction of magnetization of the external second magnet <b>230</b>. The second magnet is located directly above the capsule endoscope <b>110</b>. The capsule endoscope <b>110</b> is located below the upper wall <b>130</b> of the stomach (or above the lower wall <b>130</b> of the stomach), at a distance d from the second magnet <b>230</b>. The distance d is the distance from the center of the capsule endoscope <b>110</b> to the center of the second magnet <b>230</b>.</p>
<p id="p-0074" num="0069">At this point, the forces on the capsule endoscope <b>110</b> include the traction force F<sub>magnetic </sub>from the second magnet <b>230</b>, buoyancy force and the gravitational force W<sub>capsule </sub>of the capsule endoscope <b>110</b> itself. The traction force F<sub>magnetic </sub>is upward. So, when the capsule endoscope <b>110</b> is in the quasi-suspended state, formula (13) can be obtained according to formulas (9) to (12) below.</p>
<p id="p-0075" num="0000">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <msub>
      <mi>F</mi>
      <mi>magnetic</mi>
     </msub>
     <mo>=</mo>
     <mrow>
      <msub>
       <mi>W</mi>
       <mi>capsule</mi>
      </msub>
      <mo>-</mo>
      <mrow>
       <mi>&#x3c1;</mi>
       <mo>&#x2062;</mo>
       <mi>v</mi>
      </mrow>
     </mrow>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>9</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
<maths id="MATH-US-00005-2" num="00005.2">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mi>F</mi>
     <mo>=</mo>
     <mrow>
      <mrow>
       <mfrac>
        <msub>
         <mi>&#x3bc;</mi>
         <mn>0</mn>
        </msub>
        <mrow>
         <mn>4</mn>
         <mo>&#x2062;</mo>
         <mi>&#x3c0;</mi>
        </mrow>
       </mfrac>
       <mo>&#xd7;</mo>
       <mfrac>
        <mrow>
         <mn>6</mn>
         <mo>&#x2062;</mo>
         <mi>Mm</mi>
         <mo>&#x2062;</mo>
         <mi>cos</mi>
         <mo>&#x2062;</mo>
         <mi>&#x3b8;</mi>
        </mrow>
        <msup>
         <mi>d</mi>
         <mn>4</mn>
        </msup>
       </mfrac>
      </mrow>
      <mo>=</mo>
      <mrow>
       <mi>W</mi>
       <mo>-</mo>
       <mrow>
        <mi>&#x3c1;</mi>
        <mo>&#x2062;</mo>
        <mi>v</mi>
       </mrow>
      </mrow>
     </mrow>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>10</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
<maths id="MATH-US-00005-3" num="00005.3">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mi>d</mi>
     <mo>=</mo>
     <msup>
      <mrow>
       <mo>(</mo>
       <mrow>
        <mfrac>
         <msub>
          <mi>&#x3bc;</mi>
          <mn>0</mn>
         </msub>
         <mrow>
          <mn>4</mn>
          <mo>&#x2062;</mo>
          <mi>&#x3c0;</mi>
         </mrow>
        </mfrac>
        <mo>&#xd7;</mo>
        <mfrac>
         <mrow>
          <mn>6</mn>
          <mo>&#x2062;</mo>
          <mi>Mm</mi>
          <mo>&#x2062;</mo>
          <mi>cos</mi>
          <mo>&#x2062;</mo>
          <mi>&#x3b8;</mi>
         </mrow>
         <mrow>
          <mi>W</mi>
          <mo>-</mo>
          <mrow>
           <mi>&#x3c1;</mi>
           <mo>&#x2062;</mo>
           <mi>v</mi>
          </mrow>
         </mrow>
        </mfrac>
       </mrow>
       <mo>)</mo>
      </mrow>
      <mrow>
       <mn>1</mn>
       <mo>/</mo>
       <mn>4</mn>
      </mrow>
     </msup>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>11</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
<maths id="MATH-US-00005-4" num="00005.4">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mrow>
      <mi>cos</mi>
      <mo>&#x2062;</mo>
      <mi>&#x3b8;</mi>
     </mrow>
     <mo>=</mo>
     <mfrac>
      <msub>
       <mi>g</mi>
       <mi>z</mi>
      </msub>
      <mi>g</mi>
     </mfrac>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>12</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
</p>
<p id="p-0076" num="0070">Wherein, the magnetic sensor in the capsule endoscope <b>110</b> detects the critical magnetic field value for suspension B<sub>cr</sub>. B<sub>cr </sub>relates to formula (13) below. The critical magnetic field value for suspension B<sub>cr </sub>is obtained based on the gravitational force, the tilt angle and buoyancy force of the capsule endoscope.</p>
<p id="p-0077" num="0000">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
 <mtable>
  <mtr>
   <mtd>
    <mrow>
     <mrow>
      <msub>
       <mi>B</mi>
       <mrow>
        <mi>c</mi>
        <mo>&#x2062;</mo>
        <mi>r</mi>
       </mrow>
      </msub>
      <mo>(</mo>
      <mi>&#x3b8;</mi>
      <mo>)</mo>
     </mrow>
     <mo>=</mo>
     <mrow>
      <mfrac>
       <mrow>
        <msub>
         <mi>&#x3bc;</mi>
         <mn>0</mn>
        </msub>
        <mo>&#x2062;</mo>
        <mi>M</mi>
       </mrow>
       <mrow>
        <mn>2</mn>
        <mo>&#x2062;</mo>
        <mi>&#x3c0;</mi>
       </mrow>
      </mfrac>
      <mo>&#xd7;</mo>
      <msup>
       <mrow>
        <mo>(</mo>
        <mrow>
         <mfrac>
          <msub>
           <mi>&#x3bc;</mi>
           <mn>0</mn>
          </msub>
          <mrow>
           <mn>4</mn>
           <mo>&#x2062;</mo>
           <mi>&#x3c0;</mi>
          </mrow>
         </mfrac>
         <mo>&#xd7;</mo>
         <mfrac>
          <mrow>
           <mn>6</mn>
           <mo>&#x2062;</mo>
           <mi>Mm</mi>
           <mo>&#x2062;</mo>
           <mi>cos</mi>
           <mo>&#x2062;</mo>
           <mi>&#x3b8;</mi>
          </mrow>
          <mrow>
           <mi>W</mi>
           <mo>-</mo>
           <mrow>
            <mi>&#x3c1;</mi>
            <mo>&#x2062;</mo>
            <mi>v</mi>
           </mrow>
          </mrow>
         </mfrac>
        </mrow>
        <mo>)</mo>
       </mrow>
       <mrow>
        <mrow>
         <mo>-</mo>
         <mn>3</mn>
        </mrow>
        <mo>/</mo>
        <mn>4</mn>
       </mrow>
      </msup>
     </mrow>
    </mrow>
   </mtd>
   <mtd>
    <mrow>
     <mo>(</mo>
     <mn>13</mn>
     <mo>)</mo>
    </mrow>
   </mtd>
  </mtr>
 </mtable>
</math>
</maths>
</p>
<p id="p-0078" num="0071">In the above formulas (9) to (13), M is the magnetic moment of the second magnet <b>230</b>, m is the magnetic moment of the first magnet in the capsule endoscope <b>110</b>, &#x3bc;<sub>0 </sub>is the vacuum permeability, d is the distance from the center of the capsule endoscope <b>110</b> to the center of the second magnet <b>230</b>, W is the gravitational force of the capsule endoscope, F is the attraction force between the second magnet <b>230</b> (external magnet) and the first magnet (magnet inside the capsule), &#x3b8; is the tilt angle of the capsule endoscope <b>110</b>, g<sub>z </sub>is the axial acceleration component of the capsule endoscope, g is the gravitational acceleration, p is the specific gravity of the liquid in the stomach, and v is the volume of the capsule endoscope. In the embodiment of the present invention, the gravitational acceleration g is the total acceleration measured by the acceleration sensor, g=&#x221a;{square root over (g<sub>x</sub><sup>2</sup>+g<sub>y</sub><sup>2</sup>+g<sub>z</sub><sup>2</sup>)}, of which the value is not significantly different from 9.8. In some alternative embodiments, it can be considered that the gravitational acceleration g is a known parameter (e.g. 9.8), so a gravity sensor may be used instead of the acceleration sensor to reduce costs and to reduce the amount of calculations.</p>
<p id="p-0079" num="0072">When the capsule endoscope is located on the upper wall of the stomach, B&#x3e;B<sub>cr</sub>(&#x3b8;), e.g. B<sub>set</sub>(&#x3b8;)=1.05B<sub>cr</sub>(&#x3b8;).</p>
<p id="p-0080" num="0073">When the capsule endoscope is located on the lower wall of the stomach, B&#x3c;B<sub>cr</sub>(&#x3b8;), e.g. B<sub>set</sub>(&#x3b8;)=0.95B<sub>cr</sub>(&#x3b8;).</p>
<p id="p-0081" num="0074">The friction of the capsule endoscope has the following relationship: f<sub>friction</sub>=&#x3bc;N. When B&#x2dc;B<sub>cr</sub>, f<sub>friction</sub>, &#x2248;0. Therefore, by constantly adjusting the height of the second magnet according to the corrected magnetic field value B<sub>set</sub>, the traction force of the capsule endoscope is adjusted, the capsule endoscope can reach the quasi-suspended state, and with the horizontal movement of the second magnet <b>230</b>, the capsule endoscope can be translated in a near suspended state.</p>
<p id="p-0082" num="0075">In the embodiment shown in <figref idref="DRAWINGS">FIG. <b>2</b><i>a </i></figref>and <figref idref="DRAWINGS">FIG. <b>2</b><i>f</i></figref>, the critical magnetic field value for suspension B<sub>cr </sub>is calculated by the formulas, and in other embodiments, it can also be obtained from experimental test results. Specifically, the steps of obtaining the critical magnetic field value for suspension B<sub>cr </sub>comprise: placing the capsule endoscope directly below the second magnet, adjusting the height of the second magnet by a small distance, and recording the critical magnetic field value for suspension B<sub>cr </sub>when the capsule endoscope is about to be sucked up or to drop down by the second magnet; changing the environment in which the capsule endoscope is subjected, e.g. placing the capsule endoscope in the liquid directly below the second magnet, adjusting the height of the second magnet by a small distance, and recording the critical magnetic field value for suspension B<sub>cr </sub>when the capsule endoscope is about to be sucked up or to drop down by the second magnet; performing a plurality of experiments and recording the data to obtain accurate critical magnetic field value for suspension B<sub>cr </sub></p>
<p id="p-0083" num="0076"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a schematic illustration of a system for controlling the capsule endoscope according to an embodiment of the present invention. Referring to <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the system for controlling the capsule endoscope <b>200</b> comprises the capsule endoscope <b>110</b> and a control unit <b>210</b>, a movement unit <b>220</b>, a second magnet <b>230</b>, an image unit <b>240</b>, and a locating unit <b>250</b>. The control unit <b>210</b>, the movement unit <b>220</b>, the second magnet <b>230</b>, the image unit <b>240</b>, and the locating unit <b>250</b> are outside the capsule endoscope <b>200</b>.</p>
<p id="p-0084" num="0077">The control unit <b>210</b> receives the magnetic field data measured by the magnetic sensor and the acceleration data measured by the acceleration sensor in the capsule endoscope <b>110</b> and calculates the traction force required to keep the capsule endoscope <b>110</b> in the quasi-suspended state based on the magnetic field data and acceleration data, and then generates a control signal. That is, the control unit <b>210</b> receives data transmitted from the capsule endoscope <b>110</b> to calculate a critical magnetic field value for suspension and to obtain the control signal based on the critical magnetic field value for suspension.</p>
<p id="p-0085" num="0078">The movement unit <b>220</b> receives the control signal and controls the second magnet <b>230</b> to move in the horizontal and/or vertical direction according to the control signal, which in turn controls the movement of the capsule endoscope <b>110</b> located in the target area in the horizontal or vertical direction. The first magnet of the capsule endoscope <b>110</b> is controlled by moving the second magnet <b>230</b>, and the capsule endoscope <b>110</b> is in the quasi-suspended state as moving in the horizontal and/or vertical direction. The movement unit <b>220</b> may specifically be a robot with three-dimensional movement, a right angle coordinate robot or a robotic arm.</p>
<p id="p-0086" num="0079">The second magnet <b>230</b> may be a permanent magnet or an electromagnet. When the second magnet <b>230</b> is a permanent magnet, the traction force on the capsule endoscope <b>110</b> is controlled by changing the distance between the second magnet <b>230</b> and the first magnet in the vertical direction. When the second magnet <b>230</b> is an electromagnet, the traction force on the capsule endoscope <b>110</b> is controlled by controlling the distance between the second magnet and the first magnet in the vertical direction or the current of the second magnet <b>230</b>, so as to keep the capsule endoscope <b>110</b> in the quasi-suspended state.</p>
<p id="p-0087" num="0080">The image unit <b>240</b> is configured to receive a plurality of images captured by the capsule endoscope <b>110</b>, and obtain a panoramic image of the target area based on the captured images. Since the capsule endoscope <b>110</b> moves along the wall of the target area under the control of the second magnet <b>230</b> and captures images in the target area, a panoramic image of the target area can be synthesized from the captured images. Meanwhile, a three-dimensional spatial structure of the target area can be built according to the panoramic image, which facilitates the examination of the target area and improves the accuracy.</p>
<p id="p-0088" num="0081">The locating unit <b>250</b> is used to record position information and movement trajectory of the capsule endoscope <b>110</b>. When the capsule endoscope <b>110</b> moves along the wall of the target area, the locating unit <b>250</b> can record the position information and movement trajectory of the capsule endoscope <b>110</b> in real time, or the locating unit <b>250</b> can record the position information of the capsule endoscope <b>110</b> once every certain time. While the image unit <b>240</b> can build the three-dimensional spatial structure of the target area based on the position information and/or the movement trajectory to facilitate the examination and improve the accuracy.</p>
<p id="p-0089" num="0082">In the embodiment, the system for controlling the capsule endoscope <b>200</b> may use either manual control or automatic control to control the movement of the capsule endoscope <b>110</b> in the horizontal and/or vertical direction to collect images of the target area. The movement of the second magnet in the horizontal and/or vertical direction can also use a manual control means controlled by the movement unit and an automatic control means controlled by the control unit.</p>
<p id="p-0090" num="0083">In the manual control means, the capsule endoscope <b>110</b> needs to be placed into the target area first. The specific steps comprises: first, placing the capsule endoscope to a first point of the target area through the movement unit; second, attracting the capsule endoscope to the upper wall of the target area, activating a quasi-suspension mode of the upper wall, and automatically adjusting the height of the second magnet; third, controlling the capsule endoscope to travel in the horizontal direction through the movement unit and taking images; fourth, switching to a quasi-suspension mode of the lower wall, and automatically adjusting the height of the external magnet; fifth, controlling the capsule endoscope to travel in the horizontal direction through the movement unit and taking images; sixth, changing orientation of the target area and repeating the above steps. The quasi-suspension mode of the upper wall means the capsule endoscope is in the quasi-suspension state on the upper wall. The quasi-suspension mode of the lower wall means the capsule endoscope is in the quasi-suspension state on the lower wall.</p>
<p id="p-0091" num="0084">In the manual control method, the system <b>200</b> automatically adjusts the height of the second magnet continuously according to the critical magnetic field value for suspension B<sub>cr </sub>obtained from the test. That is, the height of the capsule endoscope in the Z direction (vertical direction) is automatically adjusted by the system <b>200</b> to achieve near-suspension translation, so the manipulator only needs to control the movement in the horizontal direction to obtain the image of the corresponding position in the target area.</p>
<p id="p-0092" num="0085">In the embodiment, the manual control means can control the capsule endoscope <b>110</b> to move to a designated position for image collection, which improves the accuracy of scanning the target area.</p>
<p id="p-0093" num="0086">In the automatic control means, the specific steps include: 1. placing the capsule endoscope to a first point of the target area; 2. attracting the capsule endoscope to the upper wall of the target area, activating a quasi-suspension mode of the upper wall, and automatically adjusting the height of the external magnet; 3. zigzag scanning the upper wall of the target area; 4. zigzag scanning the lower wall of the target area. The automatic control means is executed according to the command of the control unit.</p>
<p id="p-0094" num="0087">A rectangular coordinate system is established by: taking the center of the capsule endoscope as the coordinate origin, setting the vertical direction of the capsule endoscope as the Z axis, setting the horizontal directions of the capsule endoscope as the X and Y axes, and using the right-hand rule to establish the rectangular coordinate system. In the automatic control means, referring to <figref idref="DRAWINGS">FIG. <b>4</b></figref>, the specific steps of zigzag scanning comprise: 3.1, tilt an angle in a XY plane of the capsule endoscope to move linearly, and since the surface of the target area is arc-shaped, the second magnet controls the capsule endoscope to move in the Z direction according to the feedback thereof; 3.2, when the descending gradient in the Z direction during the linear motion of the capsule endoscope exceeds a threshold value, it is considered that the capsule endoscope reaches the edge of the target area, and it continues moving after a deflection of &#x3b8; angle; if it is needed to make the scan route tight, reduce the &#x3b8; angle, and if the scan route is too tight, increase the &#x3b8; angle; 3.3, repeat 3.1-3.2 until the gradient in the Z direction on the XY line is greater than the threshold.</p>
<p id="p-0095" num="0088">In the embodiment, the automatic control means improves the examination efficiency. Based on the images of the target area obtained by the automatic control means, the physician can generally determine the location of a lesion, and then perform a further examination of the lesion using the manual control means, which improves examination efficiency and accuracy.</p>
<p id="p-0096" num="0089">In the automatic and/or manual means, a panoramic image and a three-dimensional spatial structure of the target area can be obtained by combining the images of the upper wall and the lower wall of the target area.</p>
<p id="p-0097" num="0090">Since the capsule endoscope is in a quasi-suspended state, the friction with the target area is greatly reduced, and the injury to the target area while moving is also greatly reduced.</p>
<p id="p-0098" num="0091">According to the aspects of the present invention, the capsule endoscope is controlled to be in the quasi-suspended state, that is, the mutual attraction between the second magnet and the first magnet is equal to or slightly greater than the weight of the capsule endoscope when it is at the upper wall of the target area, equal to or slightly less than the weight of the capsule endoscope when it is at the lower wall of the target area, and offsets the buoyancy force when there is liquid in the target area, so that the pressure between the capsule endoscope and the stomach wall tends to zero, friction is greatly reduced, and the scanning of the target area is more accurate.</p>
<p id="p-0099" num="0092">According to the system and method for controlling the capsule endoscope provided by the present invention, when the capsule endoscope encounters an obstacle, the capsule endoscope is controlled to move in the vertical direction by a change in magnetic field gradient of the second magnet in the vertical direction, to bring the capsule endoscope to the quasi-suspended state, and the capsule endoscope is controlled to move in the horizontal direction by manipulating the second magnet to move in the horizontal direction to cross the obstacle.</p>
<p id="p-0100" num="0093">In the present invention, two control methods, i.e. automatic scanning and manual scanning are provided. If the position of interest is visible from the image captured by the automatic scanning method, the capsule endoscope can be controlled by the manual scanning method to move to the designated position of the target area for scanning, which improves the efficiency and accuracy of examination.</p>
<p id="p-0101" num="0094">The foregoing description of the embodiments of the invention has been presented for the purposes of illustration and description. It is not intended to be exhaustive or to limit the present invention to the precise form disclosed. It should be appreciated by persons skilled in the art that many modifications, variations, substitutions, changes, and equivalents are possible in light of the above teaching. It is, therefore, to be understood that the appended claims are intended to cover all such modifications and changes as fall within the true spirit of the present invention.</p>
<?detailed-description description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001 MATH-US-00001-2" nb-file="US20230225583A1-20230720-M00001.NB">
<img id="EMI-M00001" he="13.04mm" wi="76.20mm" file="US20230225583A1-20230720-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002 MATH-US-00002-2" nb-file="US20230225583A1-20230720-M00002.NB">
<img id="EMI-M00002" he="13.04mm" wi="76.20mm" file="US20230225583A1-20230720-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003 MATH-US-00003-2 MATH-US-00003-3" nb-file="US20230225583A1-20230720-M00003.NB">
<img id="EMI-M00003" he="19.73mm" wi="76.20mm" file="US20230225583A1-20230720-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US20230225583A1-20230720-M00004.NB">
<img id="EMI-M00004" he="6.01mm" wi="76.20mm" file="US20230225583A1-20230720-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005 MATH-US-00005-2 MATH-US-00005-3 MATH-US-00005-4" nb-file="US20230225583A1-20230720-M00005.NB">
<img id="EMI-M00005" he="24.30mm" wi="76.20mm" file="US20230225583A1-20230720-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US20230225583A1-20230720-M00006.NB">
<img id="EMI-M00006" he="6.01mm" wi="76.20mm" file="US20230225583A1-20230720-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text><b>1</b>. A system for controlling a capsule endoscope, comprising:
<claim-text>a capsule endoscope comprising an image acquisition module, a first magnet, a battery module, a wireless module, and a sensor module;</claim-text>
<claim-text>a control unit for receiving data transmitted from the capsule endoscope to calculate a critical magnetic field value for suspension and obtaining a control signal based on the critical magnetic field value for suspension;</claim-text>
<claim-text>a movement unit and a second magnet, the movement unit controlling the second magnet to move in a horizontal and/or vertical direction according to the control signal,</claim-text>
<claim-text>wherein the movement of the first magnet is controlled by moving the second magnet, the capsule endoscope is in a quasi-suspended state as moving along stomach wall in the horizontal and/or vertical direction, and the data transmitted by the capsule endoscope comprises a value of buoyancy force, a value of gravitational force, and a magnetic field value, wherein there is an angle between the direction of magnetization of the second magnet and the vertical direction, and the angle has a magnitude of 5&#x2dc;20&#xb0;.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text><b>2</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the sensor module comprises a magnetic sensor and an acceleration sensor.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text><b>3</b>. The system of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the magnetic sensor is located away from the first magnet and the acceleration sensor is a gravity sensor.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text><b>4</b>. The system of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the sensing directions of the magnetic sensor and the acceleration sensor are along the long axis of the capsule endoscope.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text><b>5</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the direction of magnetization of the first magnet is along the long axis of the capsule endoscope.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text><b>6</b>. (canceled)</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text><b>7</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the movement unit comprises a robot with three-dimensional movement, a right angle coordinate robot or a robotic arm.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text><b>8</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the second magnet comprises a permanent magnet or an electromagnet.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text><b>9</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>an image unit, which receives a plurality of images captured by the capsule endoscope and builds a three-dimensional spatial structure for the target area.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text><b>10</b>. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the image unit obtains a panoramic image of the target area according to the captured images, and the image unit obtains the three-dimensional spatial structure of the target area according to the panoramic image.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text><b>11</b>. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising:
<claim-text>a locating unit, which records position information and/or movement trajectory of the capsule endoscope; and the image unit obtains the three-dimensional spatial structure of the target area.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text><b>12</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the means for controlling the movement of the second magnet in the horizontal and/or vertical direction comprises manual control means controlled by the movement unit and automatic control means controlled by the control unit.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text><b>13</b>. A capsule endoscope comprising a first magnet inside the capsule endoscope, and a second magnet outside the capsule endoscope controlling the movement of the capsule endoscope, configured to be used by a method, comprising method:
<claim-text>measuring a magnetic field value of an environment in which the capsule endoscope is subjected;</claim-text>
<claim-text>obtaining a critical magnetic field value for suspension of the capsule endoscope according to the magnetic field value of the environment;</claim-text>
<claim-text>adjusting a traction force on the capsule endoscope according to the critical magnetic field value for suspension; and</claim-text>
<claim-text>controlling the movement of the capsule endoscope in a horizontal and/or vertical direction,</claim-text>
<claim-text>wherein the movement of the first magnet is controlled by moving the second magnet, and the capsule endoscope is in a quasi-suspended state as moving along the stomach wall in the horizontal and/or vertical direction, wherein there is an angle between the direction of magnetization of the second magnet and the vertical direction, and the angle has a magnitude of 5&#x2dc;20&#xb0;.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text><b>14</b>. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the magnetic field value is measured by a magnetic sensor, and the tilt angle is measured by an acceleration sensor.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text><b>15</b>. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the critical magnetic field value for suspension is obtained based on the gravitational force of the capsule endoscope, tilt angle of the capsule endoscope and buoyancy force of the capsule endoscope.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text><b>16</b>. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein adjusting the traction force on the capsule endoscope according to the critical magnetic field value for suspension further comprises:
<claim-text>obtaining a corrected magnetic field value according to the critical magnetic field value for suspension; and</claim-text>
<claim-text>adjusting the height of the second magnet according to the corrected magnetic field value, thereby adjusting the traction force on the capsule endoscope.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text><b>17</b>. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein when the tilt angle of the capsule endoscope is greater than zero, it is determined that the capsule endoscope encounters an obstacle.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text><b>18</b>. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein when the capsule endoscope encounters an obstacle, the capsule endoscope is controlled to move in the vertical direction by a change in magnetic field gradient of the second magnet in the vertical direction, and the capsule endoscope is controlled to move in the horizontal direction by manipulating the second magnet to move in the horizontal direction to cross the obstacle.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text><b>19</b>. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the means for controlling the movement of the capsule endoscope in the horizontal and/or vertical direction comprises manual control means and automatic control means.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text><b>20</b>. The system of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the acceleration sensor is used to measure a tilt angle of the capsule endoscope, and the capsule endoscope encounters an obstacle when the tilt angle is not 0.</claim-text>
</claim>
</claims>
</us-patent-application>
