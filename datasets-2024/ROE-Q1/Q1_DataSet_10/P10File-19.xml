<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]>
<us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230225612A1-20230720.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20230704" date-publ="20230720">
<us-bibliographic-data-application lang="EN" country="US">
<publication-reference>
<document-id>
<country>US</country>
<doc-number>20230225612</doc-number>
<kind>A1</kind>
<date>20230720</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>18186829</doc-number>
<date>20230320</date>
</document-id>
</application-reference>
<us-application-series-code>18</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>3</main-group>
<subgroup>14</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>N</subclass>
<main-group>20</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>3</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>3</main-group>
<subgroup>11</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>N</subclass>
<main-group>3</main-group>
<subgroup>08</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>V</subclass>
<main-group>40</main-group>
<subgroup>18</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>N</subclass>
<main-group>3</main-group>
<subgroup>045</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classifications-cpc>
<main-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>3</main-group>
<subgroup>145</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
</main-cpc>
<further-cpc>
<classification-cpc>
<cpc-version-indicator><date>20190101</date></cpc-version-indicator>
<section>G</section>
<class>06</class>
<subclass>N</subclass>
<main-group>20</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>3</main-group>
<subgroup>0008</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>3</main-group>
<subgroup>11</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>4064</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20130101</date></cpc-version-indicator>
<section>G</section>
<class>06</class>
<subclass>N</subclass>
<main-group>3</main-group>
<subgroup>08</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20220101</date></cpc-version-indicator>
<section>G</section>
<class>06</class>
<subclass>V</subclass>
<main-group>40</main-group>
<subgroup>193</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
<classification-cpc>
<cpc-version-indicator><date>20230101</date></cpc-version-indicator>
<section>G</section>
<class>06</class>
<subclass>N</subclass>
<main-group>3</main-group>
<subgroup>045</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20230720</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
<scheme-origination-code>C</scheme-origination-code>
</classification-cpc>
</further-cpc>
</classifications-cpc>
<invention-title id="d2e43">SMARTPHONE-BASED DIGITAL PUPILLOMETER</invention-title>
<us-related-documents>
<division>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>16618044</doc-number>
<date>20191127</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>11647903</doc-number>
</document-id>
</parent-grant-document>
<parent-pct-document>
<document-id>
<country>WO</country>
<doc-number>PCT/US2018/035432</doc-number>
<date>20180531</date>
</document-id>
</parent-pct-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>18186829</doc-number>
</document-id>
</child-doc>
</relation>
</division>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>62513808</doc-number>
<date>20170601</date>
</document-id>
</us-provisional-application>
</us-related-documents>
<us-parties>
<us-applicants>
<us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee">
<addressbook>
<orgname>University of Washington</orgname>
<address>
<city>Seattle</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
<residence>
<country>US</country>
</residence>
</us-applicant>
</us-applicants>
<inventors>
<inventor sequence="00" designation="us-only">
<addressbook>
<last-name>McGrath</last-name>
<first-name>Lynn B.</first-name>
<address>
<city>Seattle</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="01" designation="us-only">
<addressbook>
<last-name>Law</last-name>
<first-name>Anthony</first-name>
<address>
<city>Seattle</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="02" designation="us-only">
<addressbook>
<last-name>Bly</last-name>
<first-name>Randall</first-name>
<address>
<city>Seattle</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="03" designation="us-only">
<addressbook>
<last-name>Patel</last-name>
<first-name>Shwetak N.</first-name>
<address>
<city>Seattle</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="04" designation="us-only">
<addressbook>
<last-name>Mariakakis</last-name>
<first-name>Alex T.</first-name>
<address>
<city>Seattle</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
<inventor sequence="05" designation="us-only">
<addressbook>
<last-name>Baudin</last-name>
<first-name>Jacob</first-name>
<address>
<city>Seattle</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</inventor>
</inventors>
</us-parties>
<assignees>
<assignee>
<addressbook>
<orgname>University of Washington</orgname>
<role>02</role>
<address>
<city>Seattle</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
</us-bibliographic-data-application>
<abstract id="abstract">
<p id="p-0001" num="0000">In some embodiments, techniques for using machine learning to enable visible light pupilometry are provided. In some embodiments, a smartphone may be used to create a visible light video recording of a pupillary light reflex (PLR). A machine learning model may be used to detect a size of a pupil in the video recording over time, and the size over time may be presented to a clinician. In some embodiments, a system that includes a smartphone and a box that holds the smartphone in a predetermined relationship to a subject's face is provided. In some embodiments, a sequential convolutional neural network architecture is used. In some embodiments, a fully convolutional neural network architecture is used.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="218.95mm" wi="158.75mm" file="US20230225612A1-20230720-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="100.50mm" wi="153.50mm" file="US20230225612A1-20230720-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="228.43mm" wi="123.53mm" orientation="landscape" file="US20230225612A1-20230720-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="175.68mm" wi="92.37mm" orientation="landscape" file="US20230225612A1-20230720-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="233.93mm" wi="135.04mm" file="US20230225612A1-20230720-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="240.20mm" wi="166.20mm" file="US20230225612A1-20230720-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="197.36mm" wi="88.31mm" orientation="landscape" file="US20230225612A1-20230720-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="243.50mm" wi="156.46mm" file="US20230225612A1-20230720-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="106.00mm" wi="160.10mm" file="US20230225612A1-20230720-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="231.99mm" wi="145.88mm" file="US20230225612A1-20230720-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="226.23mm" wi="78.74mm" orientation="landscape" file="US20230225612A1-20230720-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="208.03mm" wi="130.30mm" orientation="landscape" file="US20230225612A1-20230720-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="216.49mm" wi="158.24mm" orientation="landscape" file="US20230225612A1-20230720-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="189.74mm" wi="143.85mm" orientation="landscape" file="US20230225612A1-20230720-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="226.91mm" wi="104.14mm" orientation="landscape" file="US20230225612A1-20230720-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="210.74mm" wi="126.41mm" orientation="landscape" file="US20230225612A1-20230720-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE(S) TO RELATED APPLICATION(S)</heading>
<p id="p-0002" num="0001">This application claims the benefit of Provisional Application No. 62/513,808, filed Jun. 1, 2017, the entire disclosure of which is hereby incorporated by reference herein for all purposes.</p>
<?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?>
<?summary-of-invention description="Summary of Invention" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">Traumatic brain injury (TBI) accounts for 30% of all injury-related deaths in the United States. TBI can occur in a variety of situations, including car accidents, falls, and blunt force trauma. A concussion is a specific form of TBI caused by a swift blow to the head; these injuries tend not to be life-threatening, but can have serious and long-term effects on a person's memory, motor abilities, and overall cognition. One area in which concussions have garnered national attention is sports, particularly contact sports such as boxing, hockey, and American football. The Center for Disease Control (CDC) estimates that there are roughly 3.8 million concussions per year in the US, and about half of them will go undiagnosed. Patients suffering a concussion have a 600% increased risk of a future head injury and 15% increased risk of permanent cognitive deficits. This is particularly more problematic for younger athletes who are not as well-educated on concussion prevention measures such as proper tackling technique. Roughly 250,000 young Americans (&#x3c;20 years old) were treated for sports-related concussions in 2009. High school football players are 3 times more likely to suffer a catastrophic head injury than college football players. Athletic departments with major funding can afford to have a team doctor with years of experience on-hand to diagnose concussions. For teams that are not as well-funded (e.g., pee-wee, middle school, high school), a school nurse, volunteer, or parent must put themselves in the same position as those doctors, but without the same tools or knowledge at their disposal. Identifying concussions immediately is essential because allowing a concussed athlete to return to play can lead to further significant injury. There exists a need for accessible concussion screening that anyone can use at any moment.</p>
<p id="p-0004" num="0003">A quantitative method to assess a TBI is to check a person's pupillary light reflex (PLR), or the manner in which their pupils react to a light stimulus. The PLR of those who have suffered a TBI is typically either slower or not as pronounced. There are two methods used by clinicians to measure the PLR. The clinical gold standard method uses a device called a pupilometer that uses infrared imaging. Infrared-based pupilometry takes advantage of the fact that there is a better demarcated boundary between the pupil and the iris when infrared imaging is used. While pupil diameter is tracked using infrared light, a ring of white LEDs stimulates the eye, causing the pupillary constriction. The components needed to make a pupilometer can be inexpensive, but the total product costs &#x2dc;4,500 USD because, among other reasons, it is a self-contained system with strict hardware requirements.</p>
<p id="p-0005" num="0004">A low-cost alternative for measuring the PLR involves using a penlight&#x2014;a pen-sized flashlight. A penlight test is performed by directing the penlight toward and away from the patient's eye. Because the PLR is manually observed by a clinician, penlight-based pupil measurements are more likely to be inaccurate and imprecise. Larson et al. note the inability of clinicians to detect small, but clinically significant responses. Characteristics such as constriction velocity and amplitude also cannot be measured in absolute terms when using a penlight; instead of reporting a constriction velocity as 3.8 mm/s, observers can only describe the PLR as &#x201c;normal,&#x201d; &#x201c;sluggish,&#x201d; or &#x201c;fixed.&#x201d; Penlight exams lack standardization as well. Clinicians purchase penlights from different companies, each with their own brightness specifications. Even if two health care providers use the same penlight, the patient may not experience the same light stimulus because of how the clinicians hold their penlights (i.e., distance and angle) or due to differences in ambient lighting conditions. Prior work has also discussed how penlight tests can lead to poor inter-observer reliability in PLR characteristics.</p>
<p id="p-0006" num="0005">A normal PLR is defined as symmetric constriction or dilation of both pupils in response to a light stimulus or its absence, respectively. The pupil size must change by a non-trivial amount within a specified time frame and should change in both eyes, regardless of which eye is stimulated. For example, when a person covers one eye while the other is exposed to bright light, the pupils of both the covered and exposed eyes should constrict, producing a phenomenon known as the consensual response.</p>
<p id="p-0007" num="0006">When given pupil diameter as a function of time, clinicians focus on five simpler quantitative measures: (1) Latency (ms): the time between the beginning of the light stimulus and the start of pupil constriction; (2) Constriction velocity (mm/s): the speed at which pupil constricts; reported as mean or max; (3) Constriction amplitude (mm): the difference between the maximum pupil diameter before light stimulation and minimum pupil diameter after light stimulation; (4) Constriction percentage (%): the constriction amplitude expressed as a percentage of the initial size; and (5) Dilation velocity (mm/s): the speed at which the pupil dilates; reported as mean or max.</p>
<p id="p-0008" num="0007">Because the neural pathways underlying the PLR include multiple brain regions and traverse many others, it is sensitive to a variety of injuries. Our motivating use case is traumatic brain injury. When the brain shifts inside the skull, it has the potential to injure both the cranial nerves carrying signals necessary for the production of the PLR or the brain regions that process these signals.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0009" num="0008">This summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This summary is not intended to identify key features of the claimed subject matter, nor is it intended to be used as an aid in determining the scope of the claimed subject matter.</p>
<p id="p-0010" num="0009">In some embodiments, a system comprising a mobile computing device is provided. The mobile computing device comprises a camera, a light source, a display, and a non-transitory computer-readable medium. The computer-readable medium has computer-executable instructions stored thereon which, in response to execution by at least one processor of the mobile computing device, cause the mobile computing device to perform actions comprising: initiating a video recording of at least one eye of a subject; activating and deactivating the light source during the video recording; ending the video recording; using a machine learning model to process the video recording to generate at least one dilation curve for the at least one eye; and presenting the at least one dilation curve on the display.</p>
<p id="p-0011" num="0010">In some embodiments, a computer-implemented method of measuring changes in a size of a pupil over time in response to a light stimulus is provided. The computing device receives a video recording of an eye of a subject, wherein the video recording was recorded by a visible light camera. The computing device uses a machine learning model to detect changes in the size of a pupil of the eye during the video recording. The computing device provides the detected changes in the size of the pupil for presentation on a display. In some embodiments, a non-transitory computer-readable medium having computer-executable instructions stored thereon is provided. The instructions, in response to execution by one or more processors of a computing device, cause the computing device to perform such a method. In some embodiments, a computing device configured to perform such a method is provided.</p>
<p id="p-0012" num="0011">In some embodiments, a computer-implemented method of generating and using a machine learning model to measure pupillary response for diagnosis of brain injury is provided. One or more mobile computing devices collect training data comprising video recordings of eyes responding to light stimuli. At least one computing devices receive tagging information indicating a location and a size of pupils in frames of each video recording. At least one computing device uses the training data and the tagging information to train a machine learning model to recognize pupil location and size in video frames. The machine learning model is stored on a mobile computing device. In some embodiments, a non-transitory computer-readable medium having computer-executable instructions stored thereon is provided. The instructions, in response to execution by one or more processors of a computing device, cause the computing device to perform such a method. In some embodiments, a computing device configured to perform such a method is provided.</p>
<?summary-of-invention description="Summary of Invention" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0013" num="0012">The foregoing aspects and many of the attendant advantages of this invention will become more readily appreciated as the same become better understood by reference to the following detailed description, when taken in conjunction with the accompanying drawings, wherein:</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates an example embodiment of a box used according to various aspects of the present disclosure;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> illustrates an example embodiment of a convolutional neural network architecture suitable for use according to various aspects of the present disclosure;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>2</b>B</figref> illustrates another example embodiment of a convolutional neural network architecture suitable for use according to various aspects of the present disclosure;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a block diagram that illustrates an example embodiment of a mobile computing device and a training computing device according to various aspects of the present disclosure;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flowchart that illustrates an example embodiment of a method of training a machine learning model to measure changes in pupil sizes over time according to various aspects of the present disclosure;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates three examples of labels created by researchers on training video recordings according to various aspects of the present disclosure;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a flowchart that illustrates an example embodiment of a method of using a machine learning model to measure changes in pupil sizes over time according to various aspects of the present disclosure;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. <b>7</b></figref> illustrates an example embodiment of a presentation of a PLR curve based on the size of the at least one pupil over time generated by the pupil measurement engine according to various aspects of the present disclosure;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a flowchart that illustrates an example embodiment of a procedure for preprocessing a video recording according to various aspects of the present disclosure;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. <b>9</b></figref> illustrates an example of processing of an example video recording according to various aspects of the present disclosure;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. <b>10</b></figref> illustrates distributions of test data used to verify performance of an embodiment of the present disclosure;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIGS. <b>11</b>A and <b>11</b>B</figref> illustrate analysis of results gathered during testing of embodiments of the present disclosure;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. <b>12</b></figref> compares several examples of PLR curves produced by an example embodiment of the present disclosure with ground truth PLR curves from manual annotations; and</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. <b>13</b></figref> shows examples of both responsive and non-responsive pupils that were collected with an embodiment of the present disclosure.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?detailed-description description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0028" num="0027">Before a person suffering from a traumatic brain injury reaches a medical facility, measuring their pupillary light reflex (PLR) is one of the few quantitative measures a clinician can use to predict their outcome. In some embodiments of the present disclosure, an application for execution on a mobile computing device (such as a smartphone app) and a box for holding the mobile computing device in relation to a face of a subject combines the repeatability, accuracy, and precision of a traditional infrared pupilometer device with the ubiquity and convenience of the penlight test that clinicians regularly use in emergency situations. The application, referred to at some points herein as &#x201c;PupilScreen,&#x201d; stimulates the patient's eyes using the smartphone's flash and records the response using the camera. The PupilScreen box, akin to a head-mounted virtual reality display, controls the eyes' exposure to light. The recorded video is processed using machine learning models such as convolutional neural networks that determine the pupil diameter over time, allowing for the derivation of clinically relevant measures. Using a fully convolutional network, the pupil diameter was tracked with a median error of 0.30 mm Clinical evaluations of the PupilScreen app and techniques disclosed herein demonstrated high fidelity of correct determinations in segregating healthy and unhealthy PLRs.</p>
<p id="p-0029" num="0028">In some embodiments, the PupilScreen system comprises two easily obtainable components: a smartphone app and a box. Smartphones are widely available, and the box can be easily created and may not require any wiring or expensive components. This means that PupilScreen can be made available to almost anyone. The box simultaneously eliminates ambient lighting conditions and controls the distance between the person's face and the flash/camera so that pixel sizes may be reliably converted into absolute measurement sizes. In some embodiments, instead of a box, a box-like or eyeglasses-like or other type of accessory can be used. The accessory can be foldable and attachable to and detachable from the smartphone. The accessory may be inconspicuous and space saving, and easy to carry around. When attached to the smartphone, the accessory performs same functions as the box, by keeping the distance of the camera from the pupil constant and blocking ambient lighting.</p>
<p id="p-0030" num="0029">In some embodiments, the PupilScreen system may not use a box or an accessory, and may instead use other techniques for dealing with ambient lighting conditions. For example, in some embodiments, the PupilScreen app may instruct the user to turn off or turn down the lights in a room in order to establish a low-level of ambient light. As another example, in some embodiments, the effects of ambient light may be dwarfed by the PLR in response to the flash, and may therefore be ignored. As still another example, data from an ambient light sensor on the smartphone may be used as an additional input to the machine learning model, and/or may be used to adjust the brightness and/or contrast of the generated video recordings to match training data.</p>
<p id="p-0031" num="0030">Also, in some embodiments, the PupilScreen system may use other techniques instead of the box for determining or compensating for a distance between the person's face and the flash/camera. For example, in some embodiments, the PupilScreen system may have the subject hold an object of known size, such as an ID card, drivers' license, coin, etc., next to the eye to be measured. The known size object can then be used to convert pixel sizes into actual sizes for each frame. As another example, in some embodiments, the PupilScreen system may use a depth sensor associated with the camera in order to determine the distance of the phone from the eye. As another example, in some embodiments, the PupilScreen system may consider pupil sizes in respect to a percentage of a size of an iris, or a percentage of a size of an eye, instead of generating absolute measurement values.</p>
<p id="p-0032" num="0031">PupilScreen can track pupil diameter with a median error of 0.30 mm with the fully convolutional network. PupilScreen can track the pupil center with a median error of 0.20 mm Using information about the pupil diameter over time, PupilScreen extracts clinically relevant measurements, including constriction amplitude, percentage, and velocity. PupilScreen can estimate constriction amplitude with a mean absolute error of 0.62 mm for a range of amplitudes of 0.32-6.02 mm, constriction percentage with a mean absolute error of 6.43% for a range of 6.21-62.00%, and max constriction velocity with a mean absolute error of 1.78 mm/s for a range of 1.37-8.99 mm/s.</p>
<p id="p-0033" num="0032">In designing a smartphone-based pupilometry system, the challenges include (1) designing a controlled setup that is portable and inexpensive, and (2) accurately identifying the pupils in video using only visible light. The PupilScreen system and method allow a smartphone to achieve repeatable PLR results at a fraction of the cost of a clinical device.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates an example embodiment of a box used according to various aspects of the present disclosure. The smartphone is placed into a slot in the back of the box. The box-phone combination serves several purposes, including: (1) the box controls the position of the phone relative to the person's face, including the distance to and alignment with the face, (2) the box eliminates the effects of ambient lighting conditions, and (3) the phone provides its own lighting within the box using a flash, which is incorporated into the smartphone. The dimensions of the box are determined such that the smartphone is held reliably in place, and the camera is centered within box. Having the camera close to the participant's face increases the effective resolution of their eyes, which allows PupilScreen to detect smaller changes in pupil diameter and measure the PLR with increased precision, but moving the phone further away allows the camera to see both eyes at once and reduces the discomfort caused by the intense flash.</p>
<p id="p-0035" num="0034">In some embodiments, the box may be 3D-printed for durability and ease of distribution. In some embodiments, the box may be made of an even cheaper material like cardboard in order to further reduce the cost. Also note that there is no electronic connection between the phone and the box, simplifying its manufacturing requirements. To make the light more tolerable to the subject, a neutral density filter and diffuser were placed directly in front of the flash using a sliding stick.</p>
<p id="p-0036" num="0035">Different network architectures can be applied. In one embodiment, the architecture is similar to PupilNet in that it involves two CNNs in sequence. However, instead of using the second network to provide a more precise estimate of the pupil center, the second network is used to estimate the pupil diameter. In this example, the first network provides a coarse estimate of the pupil center with sufficient accuracy. The second architecture is an implementation of FCN-8, a fully-convolutional neural network for achieving pixelwise segmentation.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> illustrates an example embodiment of a convolutional neural network architecture suitable for use according to various aspects of the present disclosure. The first network is trained to estimate the pupil center location. The second network is trained to learn the pupil diameter. Even if the pupil is not exactly centered using the output of the first network, the second network can be robust enough to handle those issues.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> illustrates the details of the first architecture. In this example, the first network (top) is trained to accept an image from the pre-processing step as input and return the location of the pupil center. Before being input to the network, the image is downsampled by a factor of 4. The network has 5 convolutional layers, each with a rectified linear (ReLU) activation function followed by 2&#xd7;2 pixel mean-pooling layers. The final layer of the first network is fully connected to compress information across all filters and sub-regions to an x- and y-coordinate estimate. The output labels are normalized according to the mean and standard deviation of the pupil location across the entire dataset. This is done to ensure that the same error in either direction would equally affect the network's weights during backpropagation.</p>
<p id="p-0039" num="0038">Using the output of the first network, a region of interest that is roughly 1/9th of the original image's size is cropped and centered about the estimated pupil. That region is provided to the second network (bottom), which is trained to estimate the pupil diameter. The network has a similar architecture to the first one except for the fact that it produces a single output: the pupil diameter.</p>
<p id="p-0040" num="0039">The number of layers was determined empirically to balance the tradeoff between network size and accuracy. Smaller networks are desirable so that they can fit more easily on the smartphone, but may yield less satisfactory results.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. <b>2</b>B</figref> illustrates another example embodiment of a convolutional neural network architecture suitable for use according to various aspects of the present disclosure. In this fully convolutional architecture, the first network architecture learns the pixel indices of the pupil center and the diameter of the pupil, but treats them just like any other continuous outputs rather than explicit location and size information. The second network architecture takes a different approach, viewing the problem as one of explicit segmentation. The goal of segmentation is to produce a label for every single pixel that specifies the object to which it belongs. As illustrated in <figref idref="DRAWINGS">FIG. <b>2</b>B</figref>, there are two classes for the purposes of PupilScreen: &#x201c;pupil&#x201d; and &#x201c;non-pupil&#x201d;. Implemented in this example is FCN-8, a fully convolutional architecture. In short, fully convolutional networks are normally based on a pre-trained convolutional network for image classification (e.g., VGG16). The final classifier layer is removed and replaced by layers that deconvolve, or upsample, the downsampled predictions to their original resolution. For the sake of network size, images can be downsampled by a factor of 2 before inputting them to the network.</p>
<p id="p-0042" num="0041">Once pixelwise predictions are produced, there is still the matter of measuring a pupil diameter. The largest contiguous cluster of pixels with the &#x201c;pupil&#x201d; label is treated as the pupil. The border of that cluster is smoothed using median blurring and then fit to an ellipse. The mean of the ellipse's two axes is treated as the pupil diameter for that frame.</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a block diagram that illustrates an example embodiment of a mobile computing device <b>302</b> and a training computing device <b>304</b> according to various aspects of the present disclosure. In some embodiments, the mobile computing device <b>302</b> is a smartphone such as an iPhone, an Android phone, or any other mobile computing device having the illustrated features. In some embodiments that do not use a box, any computing device having the illustrated features (such as a light source <b>306</b> and a visible light camera <b>308</b>), including but not limited to tablet computing devices, laptop computing devices, and desktop computing devices, may be used as the mobile computing device <b>302</b>.</p>
<p id="p-0044" num="0043">In some embodiments, the training computing device <b>304</b> may also be a smartphone. In some embodiments, the training computing device <b>304</b> may be a desktop computing device, server computing device, or cloud computing device that processes video recordings generated by mobile computing devices. In some embodiments, the mobile computing device <b>302</b> and the training computing device <b>304</b> may be the same computing device, or at least the same type of computing device. In some embodiments, the mobile computing device <b>302</b> and the training computing device <b>304</b> may be separate devices that communicate with each other (and/or other devices) via any suitable networking technology. In some embodiments, the training computing device <b>304</b> may create machine learning models, and the models may be transmitted to the mobile computing device <b>302</b> as part of an app download from an app store.</p>
<p id="p-0045" num="0044">As shown, the mobile computing device <b>302</b> includes a light source <b>306</b>, a visible light camera <b>308</b>, a pupil measurement engine <b>305</b>, a model data store <b>310</b>, and a video recording data store <b>312</b>. In some embodiments, the light source <b>306</b> is a source of visible light, such as an LED flash (or a flash that uses another technology) intended to provide light for taking pictures with the mobile computing device <b>302</b>. In some embodiments, the visible light camera <b>308</b> includes a CMOS image sensor and is configured to generate digital video information. Digital cameras configured to record videos and light sources are common components installed on mobile computing devices <b>302</b> such as smartphones, and so are not described further herein for the sake of brevity.</p>
<p id="p-0046" num="0045">In some embodiments, the pupil measurement engine <b>305</b> is configured to cause a video recording to be generated and stored in the video recording data store <b>310</b>. In some embodiments, the pupil measurement engine <b>305</b> may also be configured to process the video recording using a machine learning model stored in the model data store <b>310</b> in order to measure the size over time of one or more pupils in the video recording, and may be configured to provide indications of the size over time for presentation on a display. Further description of the actions performed by the pupil measurement engine <b>305</b>, model data store <b>310</b>, and video recording data store <b>312</b> is provided below.</p>
<p id="p-0047" num="0046">As shown, the training computing device <b>304</b> includes a model training engine <b>314</b>, a tagging engine <b>316</b>, a model data store <b>318</b>, and a video recording data store <b>320</b>. In some embodiments, the model training engine <b>314</b> may be configured to cause video recordings to be created for training, and/or may be configured to receive video recordings recorded by another device, and to have the recordings stored in the video recording data store <b>320</b>. In some embodiments, the tagging engine <b>316</b> is configured to cause pixels in frames of the video recordings to be tagged as either belonging to a pupil or not belonging to a pupil, and to store the tagging information along with the video recordings. Then, the model training engine <b>314</b> uses the tagging information and the video recordings to train machine learning models and to store the trained models in the model data store <b>318</b>. Further description of the actions performed by the model training engine <b>314</b>, the tagging engine <b>316</b>, the model data store <b>318</b>, and the video recording data store <b>320</b> is provided below.</p>
<p id="p-0048" num="0047">In general, the word &#x201c;engine,&#x201d; as used herein, refers to logic embodied in hardware or software instructions, which can be written in a programming language, such as C, C++, COBOL, JAVA&#x2122;, PHP, Perl, HTML, CSS, JavaScript, VBScript, ASPX, Microsoft .NET&#x2122;, Objective-C, Swift, MATLAB, and/or the like. An engine may be compiled into executable programs or written in interpreted programming languages. Software engines may be callable from other engines or from themselves. Generally, the engines described herein refer to logical divisions of functionality that can be merged with other engines, or can be divided into sub-engines. The engines can be stored in any type of computer-readable medium or computer storage device and be stored on and executed by one or more general purpose computers, thus creating a special purpose computer configured to provide the engine.</p>
<p id="p-0049" num="0048">In general, the term &#x201c;data store,&#x201d; as used herein, refers to any device that stores information on a non-transitory computer readable medium such as a magnetic drive, RAM, ROM, flash memory, and/or the like, in an organized manner. As a non-limiting example, a data store may store data within files in a file system. As more non-limiting examples, a data store may store data in a manner intended to provide high reliability, indexing, searching, and retrieval, including but not limited to a relational database management system (RDBMS), a key-value store, an object store, and/or the like.</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flowchart that illustrates an example embodiment of a method of training a machine learning model to measure changes in pupil sizes over time according to various aspects of the present disclosure. From a start block, the method <b>400</b> proceeds to block <b>402</b>, where a training computing device <b>304</b> stores one or more training video recordings of pupils of eyes responding to a light stimulus in a video recording data store <b>320</b>. In some embodiments, the video recordings may be created by the training computing device <b>304</b> itself, if it is a smartphone that is similar to the mobile computing device <b>302</b> to be used during testing. In some embodiments, the training video recordings may be created by the mobile computing device <b>302</b>, and transmitted to the training computing device <b>304</b> for training.</p>
<p id="p-0051" num="0050">An example embodiment of the recording of a training video recording, which was used in testing an embodiment of the present disclosure, is as follows: Prior to putting the box up to their face, participants were asked to take off glasses if they wore them. Once the phone was placed in the box and the participant held it up to their face, the flash was turned on briefly and autofocus was enabled. The resulting camera focus was fixed for the remainder of the study to avoid blurriness as the lighting in the box changed. The flash was then turned off and after a brief pause to allow the pupils to recover, data collection commenced. The video recording was recorded at 30 fps with 1920&#xd7;1080 resolution. After an audible 3-second countdown from the phone's speakers, the flash illuminated the participant's eyes. The stark change in lighting maximized the degree to which the pupil constricted, akin to the difference experienced when using a pupilometer. The recording stayed on for another five seconds, resulting in an 8-second long recording. The five second period after the introduction of the light stimulus was far longer than what was needed to capture the PLR, but provided extra video frames for evaluation. For each study participant, the PLR was recorded three times. Between recordings, a one-minute break was added to allow the participant to rest their eyes.</p>
<p id="p-0052" num="0051">Next, at block <b>404</b>, a tagging engine <b>316</b> of the training computing device <b>304</b> receives tagging information identifying pupil edges in the one or more training video recordings. In some embodiments, the tagging engine <b>316</b> may cause a user interface to be presented that allows a human operator to generate tagging information by labeling pixels within frames of the training video recordings as being either within a pupil or outside of a pupil. In some embodiments, the tagging information may be stored along with the training video recordings in the video recording data store <b>320</b>.</p>
<p id="p-0053" num="0052">An example embodiment of the collection of tagging information, which was used in testing an embodiment of the present disclosure, is as follows: Video recordings were manually annotated to generate ground truth labels. Using the tagging engine <b>316</b>, two researchers labeled frames by selecting points along the edges of the pupils and letting OpenCV's ellipse fitting algorithm generate a corresponding outline. <figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates three examples of the labels created by the researchers. The researchers could see and adjust the outlines to better fit the images. If the pupil was difficult to distinguish from the iris, the researchers could adjust the contrast to make it more visible. If the pupil was still too difficult to see after that, either because of poor focus or lighting, the frame was skipped; this only happened for 1.8% of the total frames encountered. The points were fit to an ellipse because not all pupils are circular. Since pupilometry is only concerned with a single pupil diameter, the ellipses were converted to circles by averaging their axes. With this method, the pupil diameters were labeled in pixels. The researchers labeled every fifth frame in the three videos from each user. Each video was 8 seconds long, but the first 3 seconds occur before the flash was turned on, resulting in 5 seconds&#xd7;30 frames/second&#xd7;(&#x2155; frames)&#xd7;3 videos=90 labeled frames per person. Frames were labeled independently of one another to avoid biases between frames; however, this led to greater variation between consecutive frames that can be primarily attributed to human error. A 3rd-order Savitzky-Golay filter was applied to temporally smooth the pupil center and diameter labels. To quantify the agreement of the labels across the researchers, both labeled a common set of 5 users (15 videos, 450 frames). The average difference between the smoothed pupil center labels was 3.46 px, which translates to 0.27 mm. The average difference between the smoothed pupil diameter labels was 2.00 px, which translates to 0.16 mm Note that these variations are not independent; if a researcher underestimated the extent of an edge, the labeled center would move away from that edge and the labeled diameter would be lower than the actual value. The degree of inter-researcher agreement can also be quantified using the intersection-over-union (IoU) measure, a standard metric for segmentation agreement between two regions. The mean IoU for the researchers' labels was 83.0%. Note that the IoU measure is calculated relative to the total area of the two labeled pupils. If the pupil center labels for a 3 mm pupil were only off by a single pixel, that difference alone would lead to an IoU score of 93.8%.</p>
<p id="p-0054" num="0053">Handling different gaze directions is a simple matter when using this technique. If the ellipse's eccentricity is too low (e.g., its axes are uneven), the frame may be rejected. Frames with a blink may similarly be rejected. Instead of averaging the axes to determine a circle, the maximum of the ellipse's axes could have been used since the dimension parallel to the direction of the rotation decreases in size; however, we chose to use the mean as a compromise between this phenomenon and the fact that some pupils have small protrusions along their perimeter that artificially extend their clinically significant boundary.</p>
<p id="p-0055" num="0054">Although a clinical-grade pupilometer could have provided an alternative method for quantifying the PLR, its results would not have been directly comparable to PupilScreen. The two setups have light stimuli with different intensities, which would result in different magnitudes of pupil constriction. Furthermore, PupilScreen eliminates the effect of ambient lighting because the box completely encloses the patient's eyes, whereas pupilometers do not since they are used in hospitals with roughly standard lighting conditions. Infrared imaging could have been used to provide a comparative ground truth measurement of pupil diameter; however, an algorithm still would have been needed to turn those frames into pupil diameters, and that algorithm would have needed its own validation.</p>
<p id="p-0056" num="0055">At procedure block <b>406</b>, the model training engine <b>314</b> of the training computing device <b>304</b> conducts a procedure that preprocesses the one or more training video recordings. An input to the procedure is one or more training video recordings, and an output of the procedure is a result of the preprocessing (e.g., one or more preprocessed video recordings). Any suitable procedure may be used for preprocessing. In general, the goals of preprocessing may be to improve contrast; to reduce data to be analyzed without unduly affecting accuracy; and so on. In some embodiments, preprocessing may include segmenting the video recording so that only a single eye/pupil is included in each video (so a video of both pupils would be split into two), or may flip video recordings so that all of the eyes are oriented in the same direction (e.g., the video recordings are flipped so that the medial canthus is on the right side of the video recording whether it depicts a left eye or a right eye). In some embodiments, preprocessing may produce additional training data, such as by jittering the video recordings. An example of a procedure suitable for use for preprocessing is described in detail below.</p>
<p id="p-0057" num="0056">Next, at block <b>408</b>, the model training engine <b>314</b> uses the preprocessed training video recordings and the tagging information to train a first convolutional neural network (CNN) to detect pupil locations in the video recordings. The method <b>400</b> then proceeds to block <b>410</b>, where the model training engine <b>314</b> uses the preprocessed training video recordings and the tagging information to train a second CNN to detect pupil sizes in the video recordings. In some embodiments, the pupil sizes and pupil locations may be indicated in absolute size (e.g., millimeters). In some embodiments, the pupil sizes and pupil locations may be indicated in pixels that could be converted to millimeters. In some embodiments, the pupil sizes and pupil locations may be indicated in percentages of total eye size (and therefore be independent of distance from the camera <b>308</b>).</p>
<p id="p-0058" num="0057">Both architectures were trained with backpropagation using batches composed of 10 images randomly sampled from the training set. To ensure that there was no overlap between training and testing data, the evaluation was conducted using 5-fold cross-validation across users; in other words, if there are N users, N/5 users are held out each time for testing and the remaining 4&#xd7;N/5 users are used for training. Recall that three videos were recorded for each user. All networks were trained for 10 epochs per fold; this number was determined empirically based on the convergence of the smoothed loss function outputs across the training data. On average, training the first network architecture took 14 mins per fold, resulting in a total training time of 14 mins&#xd7;5 folds&#xd7;2 networks=2 hours 20 mins. Training the second network architecture took 1 hours 59 mins per fold, resulting in a total training time of 119 mins&#xd7;5 folds=9 hours 55 mins. Computation was carried out by a single NVidia GeForce Titan X GPU. Testing an individual frame through either network architecture took approximately 2 ms, which means that it would take the system roughly 2 ms&#xd7;30 frame/second&#xd7;5 seconds=300 ms to test an entire video. The networks in the sequential CNN architecture were trained using batch gradient descent in order to minimize the L2 loss. The fully convolutional network was trained in the same way to minimize the per-pixel multinomial logistic loss.</p>
<p id="p-0059" num="0058">To ensure that the dataset was not significantly biased towards images of fully constricted pupils, only frames within the first 3 seconds of the light stimulus were used for training. To both generate more training samples and further promote training data diversity, training images and their associated labels were randomly jittered together (i.e., translated by a small amount). That amount was at most 10% of the input image dimensions for the first network, which was determined based on the variation of the pupil center observed in the videos. The jitter amount was at most 15% of the input image dimensions for the second network in order to sufficiently cover the spread of pupil center predictions from the first network. In this latter case, jittering the input images allows the second network to be trained to tolerate such errors.</p>
<p id="p-0060" num="0059">At block <b>412</b>, the model training engine <b>314</b> stores the first CNN and the second CNN in a model data store <b>318</b>. The method <b>400</b> then proceeds to an end block and terminates.</p>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a flowchart that illustrates an example embodiment of a method of using a machine learning model to measure changes in pupil sizes over time according to various aspects of the present disclosure. From a start block, the method <b>600</b> proceeds to block <b>602</b>, where a mobile computing device <b>302</b> generates a video recording of at least one pupil of an eye responding to a light stimulus. In some embodiments, the video recording may be stored in the video recording data store <b>312</b>. The video recording is of at least one pupil because in some embodiments, a single eye may be in the field of view of the camera <b>308</b>, while in other embodiments, both eyes may be in the field of view of the camera <b>308</b>. In some embodiments, the video recording is generated using a technique that matches the technique used to generate the training videos so that the machine learning model will be able to properly interpret the information. Accordingly, if the training videos were generated using a box, the video recording at block <b>602</b> is also generated using a box. In some embodiments, the mobile computing device <b>302</b> used at block <b>602</b> is the same type of computing device used to record the training videos. For example, both computing devices may be iPhone <b>7</b> smartphones.</p>
<p id="p-0062" num="0061">At procedure block <b>604</b>, a pupil measurement engine <b>305</b> of the mobile computing device conducts a procedure that preprocesses the video recording. An input to the procedure is the video recording, and an output of the procedure is a result of the preprocessing (e.g., one or more preprocessed video recordings). Any suitable procedure may be used for preprocessing. Typically, a procedure that matches the procedure used at procedure block <b>406</b> of <figref idref="DRAWINGS">FIG. <b>4</b></figref> is used so that the preprocessed video recording matches the preprocessed video recordings used to train the machine learning model. An example of a procedure suitable for use for preprocessing is described in detail below.</p>
<p id="p-0063" num="0062">The method <b>600</b> then proceeds to block <b>606</b>, where the pupil measurement engine <b>305</b> uses the first CNN to detect a location of a center of the at least one pupil in the preprocessed video recording. The first CNN may be stored in the model data store <b>310</b>, and may have been generated by the method <b>400</b> described above. In some embodiments, the first CNN processes the preprocessed video recording frame-by-frame to determine pupil locations in the frames. In some embodiments, a sampling of frames may be processed instead of processing every frame in the preprocessed video recording. In some embodiment, the pupil measurement engine <b>305</b> stores the location of the center of the at least one pupil along with each frame of the preprocessed video recording. Next, at block <b>608</b>, the pupil measurement engine <b>305</b> uses the second CNN and the location of the center of the at least one pupil to determine sizes of the at least one pupil in frames of the preprocessed video recording. In the sequential embodiments, the location of the center of the at least one pupil is used to crop a portion of the frames that is likely to include the pupil, such as the 1/9<sup>th </sup>portion of the frame as illustrated in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>. In the fully convolved embodiments, this may occur as well, or the output of the first CNN may be used as a continuous input to the second CNN. The second CNN may also be stored in the model data store <b>310</b>, and may have been generated by the method <b>400</b> described above. Again, the technique of block <b>608</b> may process the video recording frame by frame, using the pupil location stored for each frame, and again the technique may process either every frame or a subset of frames.</p>
<p id="p-0064" num="0063">At block <b>610</b>, the pupil measurement engine <b>305</b> uses the sizes of the at least one pupil in the frames of the preprocessed video recording to determine a size of the at least one pupil over time. In some embodiments, the pupil measurement engine <b>305</b> may store the sizes as a time series. In some embodiments, the pupil measurement engine <b>305</b> may generate a graph or chart based on the time series. In some embodiments, the pupil measurement engine <b>305</b> may convert units for the sizes.</p>
<p id="p-0065" num="0064">A PLR curve such as the graphs or charts that may be generated by the pupil measurement engine <b>305</b> shows a patient's pupil diameter as a function of time following a light stimulus. In some embodiments, the pupil measurement engine <b>305</b> may perform one or more post-processing steps to make the resulting curve more comparable to the curves provided by pupilometers, including but not limited to: (1) removing extreme prediction outliers using heuristics based on human physiology: pupils should not be smaller than 1 mm or larger than 10 mm, and the pupil diameter should not change by more than 10 mm/s; (2) smoothing the predictions (like the ground truth labels) using a 3rd-order Savitzky-Golay filter to remove undesirable fluctuations between frames that occur because the pupil diameter is estimated from each frame individually; and/or (3) scaling predictions from pixels to millimeters using a constant factor that was estimated through a device calibration procedure. A fiducial of known dimensions was placed in front of the camera at roughly the same distance as the user's eyes; its dimensions were measured in pixels and the calculated ratio was applied to all videos. This approach is not perfect since different people have different eye socket depths. Nevertheless, the ground truth labels used for analyses are all in pixels, so the conversion is primarily used to transform the results into more relevant units.</p>
<p id="p-0066" num="0065">Relevant clinical measures as described above can be extracted from the smoothed and scaled PLR curve. Calculations for the constriction amplitude and the constriction percentage may use the minimum and maximum pupil diameter. The maximum pupil diameter typically occurs at the beginning of the video since the pupil is most dilated before the light stimulus. After the pupil constricts, its diameter can fluctuate as it reaches its final equilibrium size. Because of this, the minimum diameter is identified by taking the average diameter in the last second. The maximum constriction velocity is calculated by computing the maximum of the centered derivatives across the entire curve. Although PupilScreen is designed to measure the latency between the time of the light stimulus and when the pupil begins to constrict, we found that the frame rate used may limit the granularity of the calculation ((30 fps)<sup>&#x2212;1</sup>=0.03 s/frame). If the latency is desired, higher frame rates may be used.</p>
<p id="p-0067" num="0066">At block <b>612</b>, the pupil measurement engine <b>305</b> provides the size of the at least one pupil over time for presentation on a display. The display may be a display of the mobile computing device <b>302</b>, or may be a display of another computing device, a web site, or any other suitable display. The method <b>600</b> then proceeds to an end block and terminates.</p>
<p id="p-0068" num="0067"><figref idref="DRAWINGS">FIG. <b>7</b></figref> illustrates an example embodiment of a presentation of a PLR curve based on the size of the at least one pupil over time generated by the pupil measurement engine <b>305</b> according to various aspects of the present disclosure. The PLR curve is annotated with the five common descriptive measures: (1) latency, (2) constriction velocity, (3) constriction amplitude, (4) constriction percentage, and (5) dilation velocity. An abnormal PLR curve with increased latency, slower velocities, and diminished amplitude is also included for comparison.</p>
<p id="p-0069" num="0068"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a flowchart that illustrates an example embodiment of a procedure for preprocessing a video recording according to various aspects of the present disclosure. The procedure <b>800</b> is an example of a procedure suitable for use at block <b>406</b> of <figref idref="DRAWINGS">FIG. <b>4</b></figref> and block <b>604</b> of <figref idref="DRAWINGS">FIG. <b>6</b></figref>. The input to the procedure <b>800</b> is a video recording which may be generated as described above. The procedure <b>800</b> may be executed by any suitable computing device, and is typically executed by mobile computing device <b>302</b> or training computing device <b>304</b> as described above.</p>
<p id="p-0070" num="0069">From a start block, the procedure <b>800</b> advances to optional block <b>802</b>, where a computing device crops out a portion of the video recording that does not depict a relevant area. For example, if the video recording was generated using a box, it may be known that portions of the field of view of the camera <b>308</b> depict portions of the box. Accordingly, a portion of the video (such as the bottom third) may be cropped out. This is shown in the example image illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref>. Optional block <b>802</b> is described as optional, because in some embodiments (particularly embodiments that do not use a box, or embodiments where the camera <b>308</b> is zoomed within the box to exclude the box from the field of view), a portion of the field of view may not consistently depict an irrelevant area.</p>
<p id="p-0071" num="0070">Next, at optional block <b>804</b>, the computing device splits the video recording into a left eye video and a right eye video. As shown in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the split may occur by splitting the video vertically down the middle. Optional block <b>804</b> is described as optional because in some embodiments, the video recording may depict only a single eye. At optional block <b>806</b>, the computing device flips the right eye video horizontally. By flipping the right eye video horizontally as shown in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, all of the videos will more closely match each other in shape and location, thereby improving the performance of the machine learning models. Optional block <b>806</b> is described as optional because the video recording may only depict a left eye, in which case the video recording does not have to be flipped. The above describes flipping the right eye video to match the left eye video. Of course, in some embodiments, the left eye video may be flipped to match the right eye video instead.</p>
<p id="p-0072" num="0071">At block <b>808</b>, the computing device converts the video recording(s) to a hue, saturation, and lightness (HSL) color space. The video may, for example, be captured and recorded in an sRGB or other color space. If the video recording is originally created in the HSL color space, the conversion of block <b>808</b> may not be necessary. At block <b>810</b>, the computing device applies contrast-limited adaptive histogram equalization (CLAHE) to the lightness channel of the video recording(s). Using CLAHE avoids the pitfalls of global histogram equalization by dividing an image into small tiles (88 px in our case) and then equalizing only within those individual tiles.</p>
<p id="p-0073" num="0072">At block <b>812</b>, the computing device converts the video recording(s) to grayscale. The procedure <b>800</b> then advances to an end block and terminates, returning the preprocessed video recording(s) as a result of execution.</p>
<p id="p-0074" num="0073">PupilScreen does not include an explicit blinking detection step, so all frames are tested through the CNNs regardless of the whether the pupil is visible in them or not. That being said, the CNNs are only trained on images where the pupil is visible, so cases when the pupil is not visible lead to outlier results that are handled through the post-processing described above. We found that cases of blinking were not a significant source of error in PupilScreen's results, but a blink detector could be incorporated at the beginning of PupilScreen's pipeline or within the preprocessing procedure <b>800</b> so that irrelevant frames are accounted for sooner.</p>
<heading id="h-0006" level="2">Testing</heading>
<p id="p-0075" num="0074">We collected video recordings using the PupilScreen app and box to train its CNNs and evaluate its ability to track pupil diameter. Since our approach to segmenting pupils relies on CNNs, we require a large number of training examples from individuals with various pupil sizes and iris colors. This is difficult to attain through a patient population with TBI. Cases of TBI are limited, and the pupils of those with TBI usually stay a fixed size. Because of this, our networks are trained on data from healthy volunteers at the University of Washington and Harborview Medical Center.</p>
<p id="p-0076" num="0000">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 1</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Participant demographics (N = 42)</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>SEX - N (%)</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="49pt" align="left"/>
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="126pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Male16</entry>
<entry>(38.1%)</entry>
</row>
<row>
<entry/>
<entry>Female26</entry>
<entry>(61.9%)</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<tbody valign="top">
<row>
<entry>IRIS COLOR - N (%)</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="49pt" align="left"/>
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="126pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Blue17</entry>
<entry>(40.5%)</entry>
</row>
<row>
<entry/>
<entry>Brown20</entry>
<entry>(47.6%)</entry>
</row>
<row>
<entry/>
<entry>Mixed5</entry>
<entry>(11.9%)</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0077" num="0075">Our training dataset comes from 42 volunteers: 16 males and 26 females. Typical non-infrared computer vision-based systems are reliant on determining the border between the iris and the pupil, which is more obvious for those with light blue eyes than those with dark brown eyes. For this reason, it was important to recruit participants with various iris colors. Our study includes a balanced mix of iris colors: 17 blue, 20 brown, and 5 with a noticeable gradient between different colors. In most cases, the irises that were classified as mixed were light brown near the pupil but primarily blue.</p>
<p id="p-0078" num="0076">Ideally, ethnicity should have no effect on PupilScreen's ability to measure the pupil diameter since the two are uncorrelated. Although we did not specifically ask participants for ethnicity information, we note that one-sixth of the participants had a darker skin complexion.</p>
<p id="p-0079" num="0077">The left side of <figref idref="DRAWINGS">FIG. <b>10</b></figref> shows the distribution of the pupil center location across all users after the video frames were cropped, flipped, and scaled to millimeters. The distribution is centered at the mean pupil center for reference. The distribution has a standard deviation of 3.22 mm in the x-direction. This spread can be attributed to variation in interpupillary distance and the fact that participants did not perfectly align their face within the PupilScreen box. The distribution has a standard deviation of 4.18 mm in the y-direction, which can also be attributed to different face shapes and the placement of the PupilScreen box relative to the participant's face.</p>
<p id="p-0080" num="0078">The cumulative distribution functions (CDFs) at the top of <figref idref="DRAWINGS">FIG. <b>11</b>A</figref> show the distribution of the absolute errors for the sequential network architecture. The thick dashed line in both plots compares the results to a baseline that assumes the mean predictions for all users; this is not meant to serve as a comparable algorithm, but rather ground the results relative to some other estimator. Improvement over the baseline demonstrates that the networks are learning more than just the mean value.</p>
<p id="p-0081" num="0079">The top-left of <figref idref="DRAWINGS">FIG. <b>11</b>A</figref> shows the CDF for the errors of the first network, which estimates the pupil center for a cropped input video frame. Across all users, the distribution of Euclidean errors has a median of 0.43 mm and a 90th percentile of 0.87 mm. The error distributions across the different iris colors are nearly identical. The magnitude of the error can partly be attributed to the pre-processing of the video frame. Input images are downsampled by a factor of 4, which reduces the resolution of the pupil center estimation to 0.31 mm Despite the loss of resolution, the errors are well within the diameter of the iris (10-12 mm). In fact, most are within the smallest observed pupil diameters (&#x2dc;2 mm). Although it is ideal for the pupil to be centered in the image that is input to the second network, the most important result is that the eye always remains in the region of interest that is cropped around the center prediction. By jittering the training data, the second network is trained to handle shifted images.</p>
<p id="p-0082" num="0080">The top-right of <figref idref="DRAWINGS">FIG. <b>11</b>A</figref> shows a similar CDF plot for the errors of the second network, which estimates the pupil diameter given an image cropped using the pupil center output by the first network. Across all users, the distribution of absolute errors has a median of 0.36 mm and a 90th percentile of 1.09 mm According to Meeker et al., the error of PupilScreen's diameter estimation is better than that of manual examination (0.5 mm), but worse than that of a clinical pupilometer (0.23 mm). To determine if the error of the first network leads to greater errors in the second network, we examined the accuracy of the second network given input images cropped around the ground truth pupil center. We found that there was little difference between using the predicted pupil centers and the ground truth pupil centers (50th: 0.36 mm, 90th: 1.19 mm vs. 50th: 0.36 mm, 90th: 1.15 mm). The fact that using the ground truth centers did not improve the accuracy of the pupil diameter estimation may be a byproduct of the fact that the training data was jittered, leading the network to be invariant to exact pupil location.</p>
<p id="p-0083" num="0081">The Bland-Altmann plots in the bottom half of <figref idref="DRAWINGS">FIG. <b>11</b>A</figref> show a different representation of the diameter prediction errors split across the different iris colors. In all cases, the sequential network architecture tends to overestimate the pupil diameter. If the CNN relies upon convolutional filters that look for edges, overestimation could be happening because those filters are more likely to respond to regions outside of the pupil's actual boundary. The mean pupil diameter errors are +0.24 mm, +0.27 mm, and +0.07 mm for blue, brown, and mixed eyes, respectively.</p>
<p id="p-0084" num="0082">We find that the most extreme outliers belong to a small subset of participants who had particularly dark irises. We believe that this error can be reduced with more training data from participants with similarly dark irises.</p>
<p id="p-0085" num="0083"><figref idref="DRAWINGS">FIG. <b>11</b>B</figref> shows the same performance measures for the fully convolutional architecture. The CDFs at the top of the figure show that the fully convolutional network was generally more accurate than using sequential networks. Across all users, the distribution of Euclidean errors for the pupil center has a median of 0.20 mm and a 90<sup>th </sup>percentile of 0.50 mm. The distribution of absolute errors for the pupil diameter has a median of 0.30 nm, which is closer to the observed accuracy of a clinical pupilometer than the 0.36 mm median error of the sequential network architecture. Examining the Bland-Altmann plots in <figref idref="DRAWINGS">FIG. <b>11</b></figref>, we find that the fully convolutional architecture tends to underestimate the pupil diameter. The mean pupil diameter errors are &#x2212;0.11 mm, &#x2212;0.20 mm, and &#x2212;0.55 mm for blue, brown, and mixed eyes, respectively. Beyond the inherent differences between the two architectures from a deep learning standpoint, one reason for the improved results could be the fact that explicit morphological operations could be performed on the pixel labels; rather than hoping that the network could learn some attribute in regards to smooth edges, it is easier exercise domain-knowledge and enforce such rules afterwards. The post-processing could also explain why this architecture underestimated diameters; although smoothing can remove protrusions from a jagged pupil boundary estimate, it can also shrink an otherwise correct, smooth pupil boundary estimate.</p>
<p id="p-0086" num="0084">There is a noticeable difference between the results for different iris colors. For both architectures, images of brown eyes led to the worst results. The sequential network architecture had a median error of 0.41 mm and a 90th percentile error of 1.19 mm, and the fully convolutional architecture had a median error of 0.33 mm and a 90th percentile error of 1.14 mm. This may be because the boundary between the pupil and the iris is less noticeable for people with darker irises, so the convolutional filters in the networks are less likely to respond to the appropriate regions of the eye. We also hypothesize that this is the reason for why the measured diameter error for brown eyes does not correlate with the pupil size as it does with the lighter iris colors, a phenomenon noted by Meeker et al. when pupils were manually examined.</p>
<p id="p-0087" num="0085">The outputs of PupilScreen's networks are useful once they are combined sequentially in PLR curves. For the sake of brevity, the results from here on out come from the fully convolutional architecture since it was slightly more accurate. To quantify how well the predicted PLR curves track the human-labeled PLR curves, their normalized cross-correlation was calculated. The average normalized cross-correlation across all videos is 0.91. <figref idref="DRAWINGS">FIG. <b>12</b></figref> compares several examples of PLR curves produced by PupilScreen with ground truth PLR curves from manual annotations. The left chart is an example where PupilScreen accurately estimates all PLR metrics. The center chart is an example where PupilScreen accurately estimates the maximum constriction velocity, but underestimates the constriction amplitude and percentage. The right chart is an example where PupilScreen accurately estimates the constriction amplitude and maximum constriction velocity, but underestimates the constriction percentage.</p>
<p id="p-0088" num="0086">Table 2 describes how well PupilScreen is able to predict PLR metrics relative to those measured from the manually labeled dataset. Table 2 also shows the range of those metrics across all participants as a point of comparison for the error magnitude. PupilScreen can track constriction amplitude with a mean error of 0.62 mm, constriction percentage within a mean error of 6.43%, and max constriction velocity with a mean error of 1.78 mm/s. As a point of comparison from the literature, an evaluation of PupilWare by Rafiqi et al. demonstrated that their system tracked constriction and dilation percentages with an accuracy such that 90% of their predictions fell within 10% of the ground truth. However, there are many differences between PupilWare and PupilScreen that make these results difficult to compare. PupilScreen was evaluated on many more participants than PupilWare (42 vs. 9), but the evaluation of PupilWare aggregated a time series of percent change values rather than the single summary statistic like PupilScreen. The two systems are also intended for different applications. PupilWare is designed to track changes in pupil size attributed to varying cognitive load, which tend to be smaller in amplitude than the changes induced in PupilScreen.</p>
<p id="p-0089" num="0000">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 2</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>PLR metric evaluation</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>CONSTRICTION AMPLITUDE - mm</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="21pt" align="left"/>
<colspec colname="1" colwidth="112pt" align="left"/>
<colspec colname="2" colwidth="84pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Ground truth range</entry>
<entry>0.32-6.02</entry>
</row>
<row>
<entry/>
<entry>Mean absolute error</entry>
<entry>0.62</entry>
</row>
<row>
<entry/>
<entry>Standard deviation of absolute error</entry>
<entry>0.72</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<tbody valign="top">
<row>
<entry>CONSTRICTION PERCENTAGE - %</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="21pt" align="left"/>
<colspec colname="1" colwidth="112pt" align="left"/>
<colspec colname="2" colwidth="84pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Ground truth range</entry>
<entry>&#x2002;6.21-62.00</entry>
</row>
<row>
<entry/>
<entry>Mean absolute error</entry>
<entry>6.43</entry>
</row>
<row>
<entry/>
<entry>Standard deviation of absolute error</entry>
<entry>6.74</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<tbody valign="top">
<row>
<entry>MAX CONSTRICTION VELOCITY - mm/s</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="21pt" align="left"/>
<colspec colname="1" colwidth="112pt" align="left"/>
<colspec colname="2" colwidth="84pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>Ground truth range</entry>
<entry>1.37-8.99</entry>
</row>
<row>
<entry/>
<entry>Mean absolute error</entry>
<entry>1.78</entry>
</row>
<row>
<entry/>
<entry>Standard deviation of absolute error</entry>
<entry>0.67</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0090" num="0087">Examining the predicted PLR curves further provides insight into the nature of these errors. The center and right plots in <figref idref="DRAWINGS">FIG. <b>12</b></figref> show cases where a repeated error across frames led to the inaccurate estimation of some PLR metrics, but not others. In the center, PupilScreen correctly tracks the pupil diameter during constriction, but then overestimates the final diameter of the pupil after constriction. The max constriction velocity is correctly estimated in these situations, but the constriction amplitude and percentage are not. On the right, PupilScreen follows the ground truth PLR curve with a roughly constant offset. This means that although the absolute estimate of the pupil diameter may be off, the change between the minimum and maximum pupil remains unchanged. This behavior only affects the constriction percentage since it relies on an absolute baseline; the constriction velocity and amplitude remain unaffected. Although not shown in <figref idref="DRAWINGS">FIG. <b>12</b></figref>, errors in all three metrics can also be attributed to pupil diameter predictions that deviated from nearby frames in a manner that failed PupilScreen's outlier criteria but were significant enough to create a deflection in the filtered PLR curve.</p>
<p id="p-0091" num="0088">To gauge PupilScreen's diagnostic efficacy, we supplemented our dataset with videos from six patients at Harborview Medical Center's trauma ward and neuro-intensive care unit (neuro-ICU). These individuals had sustained significant head trauma, but were stable enough at the time to be recruited for the study. Their doctors and nurses knew beforehand that they had non-reactive pupils. Non-reactive pupils are frequently observed in patients whose condition is unstable, making it difficult to use our research prototype without interfering with the clinician's workflow. As before, three videos were recorded for each patient; however, there were complications in collecting these videos, including the inability of the patients to keep their eyes open and the inability of the clinician to maintain the position of the box while recording the videos. Because of these issues, only 24 of the 36 possible PLR curves (3 videos per patient&#xd7;2 eyes per patient&#xd7;6 patients) were suitable for analysis.</p>
<p id="p-0092" num="0089">To evaluate PupilScreen's accuracy on non-reactive pupils, we randomly selected one of the folds created during our initial training and analysis. The patient videos were processed using the CNNs that were trained on that fold's training data to produce pathologic PLR curves. An equal number of healthy PLR curves were generated using randomly selected videos from that fold's test set. Using the same network for both sets of videos guaranteed that the PLR curves were generated from networks that were trained on the same data. <figref idref="DRAWINGS">FIG. <b>13</b></figref> shows examples of both responsive and non-responsive pupils that were collected with PupilScreen. The PLR curves from healthy individuals have a noticeable exponential decay, whereas the PLR curves from the patients do not.</p>
<p id="p-0093" num="0090">The PLR curves were anonymized, shuffled, and then sent to two clinicians familiar with pupilometry. The clinicians were asked to classify the PLRs as either &#x201c;responsive&#x201d; or &#x201c;non-responsive&#x201d;. They were not told how many curves would be in each category, nor were they shown the video recordings themselves. The first clinician was able to correctly classify every curve in our dataset. The second clinician misclassified one non-responsive PLR curve as responsive. In that particular case, PupilScreen estimated that the person's pupil constricted in a slow and almost linear manner, but by a significant amplitude. The second clinician also misclassified one responsive PLR curve as non-responsive, again, due to the borderline pupil constriction amplitude.</p>
<p id="p-0094" num="0091">Throughout our design process, we asked clinicians about their personal experiences with pupilometry and for feedback on PupilScreen's design. These clinicians included surgeons, nurses, and other personnel at the Harborview Medical Center's neuro-ICU. Although PupilScreen is proposed as a tool to be used by team doctors and parents, clinicians who work with TBI are far more familiar with existing pupilometry methods and their tradeoffs and could provide far more insight beyond novelty.</p>
<p id="p-0095" num="0092">One of the surprising findings early on was that although the clinicians were familiar with the purpose of a pupilometer and its advantages over a penlight test, the pupilometer was hardly used in the clinical setting. The pupilometer was mainly used to track changes in PLR over a long period of time to identify worsening injuries as quickly as possible in otherwise unresponsive patients. For diagnosis or triage, penlights are strongly preferred for their simplicity and ease of access, despite the limited precision and lack of consistency they afford. As one clinician stated, &#x201c;If whatever you ask an EMT to do adds twenty seconds or so, it's not worth it&#x201d;. In fact, we found that some clinicians use their smartphone's flash instead of a penlight, validating aspects of our idea. When we asked the clinicians about the prospect of PupilScreen's convenience, they were excited by the idea of a smartphone app that would be in their pockets at all times.</p>
<p id="p-0096" num="0093">While illustrative embodiments have been illustrated and described, it will be appreciated that various changes can be made therein without departing from the spirit and scope of the invention.</p>
<?detailed-description description="Detailed Description" end="tail"?>
</description>
<claims id="claims">
<claim id="CLM-01-24" num="01-24">
<claim-text><b>1</b>-<b>24</b>. (canceled)</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text><b>25</b>. A computer-implemented method of generating and using a machine learning model to measure pupillary response for diagnosis of brain injury, the method comprising:
<claim-text>collecting, using one or more mobile computing devices, training data comprising video recordings of eyes responding to light stimuli;</claim-text>
<claim-text>receiving, by at least one computing device, tagging information indicating a location and a size of pupils in frames of each video recording;</claim-text>
<claim-text>using, by at least one computing device, the training data and the tagging information to train a machine learning model to recognize pupil location and size in video frames; and</claim-text>
<claim-text>storing the machine learning model on a mobile computing device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text><b>26</b>. The method of <claim-ref idref="CLM-00025">claim 25</claim-ref>, further comprising:
<claim-text>collecting, using the mobile computing device, experimental data comprising a video recording of at least one eye of a subject responding to a light stimulus;</claim-text>
<claim-text>using, by the mobile computing device, the machine learning model to determine changes over time in a size of a pupil of the at least one eye; and</claim-text>
<claim-text>presenting, by the mobile computing device, a plot of the changes over time in the size of the pupil of the at least one eye.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text><b>27</b>. The method of <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the machine learning model includes at least one convolutional neural network (CNN).</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text><b>28</b>. The method of <claim-ref idref="CLM-00027">claim 27</claim-ref>, wherein the machine learning model includes a first CNN configured to recognize a pupil location and a second CNN configured to determine a pupil diameter.</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text><b>29</b>. The method of <claim-ref idref="CLM-00027">claim 27</claim-ref>, wherein the at least one CNN includes 5 convolutional layers and three fully connected layers.</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text><b>30</b>. The method of <claim-ref idref="CLM-00027">claim 27</claim-ref>, wherein convolutional layers of the at least one CNN include a rectified linear (ReLU) activation function followed by 2&#xd7;2 mean-pooling layers.</claim-text>
</claim>
<claim id="CLM-00031" num="00031">
<claim-text><b>31</b>. The method of <claim-ref idref="CLM-00026">claim 26</claim-ref>, further comprising preprocessing at least one of the training data and the experimental data.</claim-text>
</claim>
<claim id="CLM-00032" num="00032">
<claim-text><b>32</b>. The method of <claim-ref idref="CLM-00031">claim 31</claim-ref>, wherein preprocessing includes one or more of:
<claim-text>cropping the video recording;</claim-text>
<claim-text>down-sampling the video recording;</claim-text>
<claim-text>converting the video recording to a hue, saturation, and lightness (HSL) color space;</claim-text>
<claim-text>applying contrast-limited adaptive histogram equalization (CLAHE) to a lightness channel of the video recording; and</claim-text>
<claim-text>converting the video recording to grayscale.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00033" num="00033">
<claim-text><b>33</b>. A non-transitory computer-readable medium having computer-executable instructions stored thereon which, in response to execution by one or more processors of one or more computing devices, cause the one or more computing devices to perform actions comprising:
<claim-text>collecting, using one or more mobile computing devices, training data comprising video recordings of eyes responding to light stimuli;</claim-text>
<claim-text>receiving, by at least one computing device, tagging information indicating a location and a size of pupils in frames of each video recording;</claim-text>
<claim-text>using, by at least one computing device, the training data and the tagging information to train a machine learning model to recognize pupil location and size in video frames; and</claim-text>
<claim-text>storing the machine learning model on a mobile computing device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00034" num="00034">
<claim-text><b>34</b>. (canceled)</claim-text>
</claim>
<claim id="CLM-00035" num="00035">
<claim-text><b>35</b>. The computer-readable medium of <claim-ref idref="CLM-00033">claim 33</claim-ref>, wherein the actions further comprise:
<claim-text>collecting, using the mobile computing device, experimental data comprising a video recording of at least one eye of a subject responding to a light stimulus;</claim-text>
<claim-text>using, by the mobile computing device, the machine learning model to determine changes over time in a size of a pupil of the at least one eye; and</claim-text>
<claim-text>presenting, by the mobile computing device, a plot of the changes over time in the size of the pupil of the at least one eye.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00036" num="00036">
<claim-text><b>36</b>. The computer-readable medium of <claim-ref idref="CLM-00033">claim 33</claim-ref>, wherein the machine learning model includes at least one convolutional neural network (CNN), including at least a first CNN configured to recognize a pupil location and a second CNN configured to determine a pupil diameter.</claim-text>
</claim>
<claim id="CLM-00037" num="00037">
<claim-text><b>37</b>. The computer-readable medium of <claim-ref idref="CLM-00036">claim 36</claim-ref>, wherein the at least one CNN includes 5 convolutional layers and three fully connected layers.</claim-text>
</claim>
<claim id="CLM-00038" num="00038">
<claim-text><b>38</b>. The computer-readable medium of <claim-ref idref="CLM-00036">claim 36</claim-ref>, wherein convolutional layers of the at least one CNN include a rectified linear (ReLU) activation function followed by 2&#xd7;2 mean-pooling layers.</claim-text>
</claim>
<claim id="CLM-00039" num="00039">
<claim-text><b>39</b>. The computer-readable medium of <claim-ref idref="CLM-00035">claim 35</claim-ref>, wherein the actions further comprise preprocessing at least one of the training data and the experimental data;
<claim-text>wherein preprocessing includes one or more of:
<claim-text>cropping the video recording;</claim-text>
<claim-text>down-sampling the video recording;</claim-text>
<claim-text>converting the video recording to a hue, saturation, and lightness (HSL) color space;</claim-text>
<claim-text>applying contrast-limited adaptive histogram equalization (CLAHE) to a lightness channel of the video recording; and</claim-text>
<claim-text>converting the video recording to grayscale.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00040" num="00040">
<claim-text><b>40</b>. A computing system comprising:
<claim-text>one or more mobile computing devices configured to collect training data comprising video recordings of eyes responding to light stimuli;</claim-text>
<claim-text>at least one computing device configured to receive tagging information indicating a location and a size of pupils in frames of each video recording;</claim-text>
<claim-text>at least one computing device configured to use the training data and the tagging information to train a machine learning model to recognize pupil location and size in video frames; and</claim-text>
<claim-text>a mobile computing device configured to store the machine learning model.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00041" num="00041">
<claim-text><b>41</b>. The system <claim-ref idref="CLM-00040">claim 40</claim-ref>, wherein the mobile computing device configured to store the machine learning model is further configured to:
<claim-text>collect experimental data comprising a video recording of at least one eye of a subject responding to a light stimulus;</claim-text>
<claim-text>use the machine learning model to determine changes over time in a size of a pupil of the at least one eye; and</claim-text>
<claim-text>present a plot of the changes over time in the size of the pupil of the at least one eye.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00042" num="00042">
<claim-text><b>42</b>. The system of <claim-ref idref="CLM-00040">claim 40</claim-ref>, wherein the machine learning model includes at least one convolutional neural network (CNN), including at least a first CNN configured to recognize a pupil location and a second CNN configured to determine a pupil diameter.</claim-text>
</claim>
<claim id="CLM-00043" num="00043">
<claim-text><b>43</b>. The system of <claim-ref idref="CLM-00042">claim 42</claim-ref>, wherein the at least one CNN includes 5 convolutional layers and three fully connected layers.</claim-text>
</claim>
<claim id="CLM-00044" num="00044">
<claim-text><b>44</b>. The system of <claim-ref idref="CLM-00042">claim 42</claim-ref>, wherein convolutional layers of the at least one CNN include a rectified linear (ReLU) activation function followed by 2&#xd7;2 mean-pooling layers.</claim-text>
</claim>
<claim id="CLM-00045" num="00045">
<claim-text><b>45</b>. The system of <claim-ref idref="CLM-00043">claim 43</claim-ref>, wherein the system further comprises at least one computing device configured to preprocess at least one of the training data and the experimental data;
<claim-text>wherein preprocessing includes one or more of:
<claim-text>cropping the video recording;</claim-text>
<claim-text>down-sampling the video recording;</claim-text>
<claim-text>converting the video recording to a hue, saturation, and lightness (HSL) color space;</claim-text>
<claim-text>applying contrast-limited adaptive histogram equalization (CLAHE) to a lightness channel of the video recording; and</claim-text>
<claim-text>converting the video recording to grayscale.</claim-text>
</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-application>
